<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-build/migrations/upgrading">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.0">
<title data-rh="true">Upgrading Cosmos SDK | Explore the SDK</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://docs.cosmos.network/img/banner.jpg"><meta data-rh="true" name="twitter:image" content="https://docs.cosmos.network/img/banner.jpg"><meta data-rh="true" property="og:url" content="https://docs.cosmos.network/main/build/migrations/upgrading"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Upgrading Cosmos SDK | Explore the SDK"><meta data-rh="true" name="description" content="This guide provides instructions for upgrading to specific versions of Cosmos SDK."><meta data-rh="true" property="og:description" content="This guide provides instructions for upgrading to specific versions of Cosmos SDK."><link data-rh="true" rel="icon" href="/img/favicon.svg"><link data-rh="true" rel="canonical" href="https://docs.cosmos.network/main/build/migrations/upgrading"><link data-rh="true" rel="alternate" href="https://docs.cosmos.network/main/build/migrations/upgrading" hreflang="en"><link data-rh="true" rel="alternate" href="https://docs.cosmos.network/main/build/migrations/upgrading" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://QLS2QSP47E-dsn.algolia.net" crossorigin="anonymous"><link rel="search" type="application/opensearchdescription+xml" title="Explore the SDK" href="/opensearch.xml">


<link rel="preconnect" href="https://www.google-analytics.com">
<script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-51029217-2","auto"),ga("set","anonymizeIp",!0),ga("send","pageview")</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>



<script src="https://widget.kapa.ai/kapa-widget.bundle.js" data-website-id="752cab42-f5d6-4af3-9d31-fb0d6e501c4a" data-project-name="Cosmos SDK" data-project-color="#5064FB" data-modal-disclaimer="This is a custom LLM for Interchain with access to Cosmos SDK developer documentation and resources. Please note that answers are generated by an AI so please use your best judgement before implementing." data-modal-image="img/logo-sdk.svg" data-project-logo="img/logo-sdk-white.svg" data-user-analytics-fingerprint-enabled="true" async></script><link rel="stylesheet" href="/assets/css/styles.0425b9d4.css">
<link rel="preload" href="/assets/js/runtime~main.ae6eca12.js" as="script">
<link rel="preload" href="/assets/js/main.5e40e4cd.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" target="_self" href="/"><div class="navbar__logo"><img src="/img/logo-sdk.svg" alt="Cosmos SDK Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/logo-sdk.svg" alt="Cosmos SDK Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">Cosmos SDK</b></a><a class="navbar__item navbar__link" href="/main/learn">Learn</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/main/build/building-modules/intro">Build</a><a class="navbar__item navbar__link" href="/main/user">User Guides</a><a class="navbar__item navbar__link" href="/main/tutorials/vote-extensions/auction-frontrunning/getting-started">Tutorials</a><a class="navbar__item navbar__link" href="/api">REST API</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/cosmos/cosmos-sdk" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="github-icon">
            <path fill-rule="evenodd" clip-rule="evenodd" d="M12 0.300049C5.4 0.300049 0 5.70005 0 12.3001C0 17.6001 3.4 22.1001 8.2 23.7001C8.8 23.8001 9 23.4001 9 23.1001C9 22.8001 9 22.1001 9 21.1001C5.7 21.8001 5 19.5001 5 19.5001C4.5 18.1001 3.7 17.7001 3.7 17.7001C2.5 17.0001 3.7 17.0001 3.7 17.0001C4.9 17.1001 5.5 18.2001 5.5 18.2001C6.6 20.0001 8.3 19.5001 9 19.2001C9.1 18.4001 9.4 17.9001 9.8 17.6001C7.1 17.3001 4.3 16.3001 4.3 11.7001C4.3 10.4001 4.8 9.30005 5.5 8.50005C5.5 8.10005 5 6.90005 5.7 5.30005C5.7 5.30005 6.7 5.00005 9 6.50005C10 6.20005 11 6.10005 12 6.10005C13 6.10005 14 6.20005 15 6.50005C17.3 4.90005 18.3 5.30005 18.3 5.30005C19 7.00005 18.5 8.20005 18.4 8.50005C19.2 9.30005 19.6 10.4001 19.6 11.7001C19.6 16.3001 16.8 17.3001 14.1 17.6001C14.5 18.0001 14.9 18.7001 14.9 19.8001C14.9 21.4001 14.9 22.7001 14.9 23.1001C14.9 23.4001 15.1 23.8001 15.7 23.7001C20.5 22.1001 23.9 17.6001 23.9 12.3001C24 5.70005 18.6 0.300049 12 0.300049Z" fill="currentColor"/>
            </svg>
            </a><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a class="navbar__link" aria-haspopup="true" aria-expanded="false" role="button" href="/main/learn">Next</a><ul class="dropdown__menu"><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/main/build/migrations/upgrading">Next</a></li><li><a class="dropdown__link" href="/v0.52/build/migrations/upgrading">v0.52</a></li><li><a class="dropdown__link" href="/v0.50/build/migrations/upgrading">v0.50</a></li><li><a class="dropdown__link" href="/v0.47/build/migrations/upgrading">v0.47</a></li><li><a href="https://docs.cosmos.network/v0.46/" target="_self" rel="noopener noreferrer" class="dropdown__link">v0.46<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><a href="https://docs.cosmos.network/v0.45/" target="_self" rel="noopener noreferrer" class="dropdown__link">v0.45<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/main/build">Build</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/main/build/building-apps/app-go">Building Apps</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/main/build/building-modules/intro">Building Modules</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/main/build/abci/introduction">ABCI</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/main/build/modules">Modules</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/main/build/migrations/intro">Migrations</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/main/build/migrations/intro">SDK Migrations</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/main/build/migrations/upgrading">Upgrading Cosmos SDK</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/main/build/packages">Packages</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/main/build/tooling">Tooling</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/main/build/architecture">ADRs</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/main/build/rfc">RFC</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/main/build/spec">Specifications</a></div></li></ul></nav></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="theme-doc-version-banner alert alert--warning margin-bottom--md" role="alert"><div>This is unreleased documentation for <!-- -->Explore the SDK<!-- --> <b>Next</b> version.</div><div class="margin-top--md">For up-to-date documentation, see the <b><a href="/v0.52/build/migrations/upgrading">latest version</a></b> (<!-- -->v0.52<!-- -->).</div></div><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Migrations</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Upgrading Cosmos SDK</span><meta itemprop="position" content="2"></li></ul></nav><span class="theme-doc-version-badge badge badge--secondary">Version: Next</span><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Upgrading Cosmos SDK</h1><p>This guide provides instructions for upgrading to specific versions of Cosmos SDK.
Note, always read the <strong>SimApp</strong> section for more information on application wiring updates.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="unreleased">[Unreleased]<a href="#unreleased" class="hash-link" aria-label="Direct link to [Unreleased]" title="Direct link to [Unreleased]">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="baseapp">BaseApp<a href="#baseapp" class="hash-link" aria-label="Direct link to BaseApp" title="Direct link to BaseApp">​</a></h3><h4 class="anchor anchorWithStickyNavbar_LWe7" id="nested-messages-simulation">Nested Messages Simulation<a href="#nested-messages-simulation" class="hash-link" aria-label="Direct link to Nested Messages Simulation" title="Direct link to Nested Messages Simulation">​</a></h4><p>Now it is possible to simulate the nested messages of a message, providing developers with a powerful tool for
testing and predicting the behavior of complex transactions. This feature allows for a more comprehensive
evaluation of gas consumption, state changes, and potential errors that may occur when executing nested
messages. However, it&#x27;s important to note that while the simulation can provide valuable insights, it does not
guarantee the correct execution of the nested messages in the future. Factors such as changes in the
blockchain state or updates to the protocol could potentially affect the actual execution of these nested
messages when the transaction is finally processed on the network.</p><p>For example, consider a governance proposal that includes nested messages to update multiple protocol
parameters. At the time of simulation, the blockchain state may be suitable for executing all these nested
messages successfully. However, by the time the actual governance proposal is executed (which could be days or
weeks later), the blockchain state might have changed significantly. As a result, while the simulation showed
a successful execution, the actual governance proposal might fail when it&#x27;s finally processed.</p><p>By default, when simulating transactions, the gas cost of nested messages is not calculated. This means that
only the gas cost of the top-level message is considered. However, this behavior can be customized using the
<code>SetIncludeNestedMsgsGas</code> option when building the BaseApp. By providing a list of message types to this option,
you can specify which messages should have their nested message gas costs included in the simulation. This
allows for more accurate gas estimation for transactions involving specific message types that contain nested
messages, while maintaining the default behavior for other message types.</p><p>Here is an example on how <code>SetIncludeNestedMsgsGas</code> option could be set to calculate the gas of a gov proposal
nested messages:</p><div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">baseAppOptions </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">append</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">baseAppOptions</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> baseapp</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">SetIncludeNestedMsgsGas</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">sdk</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Message</span><span class="token punctuation" style="color:#393A34">{</span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain">gov</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">MsgSubmitProposal</span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">app</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">App </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> appBuilder</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Build</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">db</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> traceStore</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> baseAppOptions</span><span class="token operator" style="color:#393A34">...</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>To be able to simulate nested messages within a transaction, message types containing nested messages must implement the
<code>HasNestedMsgs</code> interface. This interface requires a single method: <code>GetMsgs() ([]sdk.Msg, error)</code>, which should return
the nested messages. By implementing this interface, the BaseApp can simulate these nested messages during
transaction simulation. </p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="v052x"><a href="https://github.com/cosmos/cosmos-sdk/releases/tag/v0.52.0-beta.1" target="_blank" rel="noopener noreferrer">v0.52.x</a><a href="#v052x" class="hash-link" aria-label="Direct link to v052x" title="Direct link to v052x">​</a></h2><p>Documentation to migrate an application from v0.50.x to server/v2 is available elsewhere.
It is additional to the changes described here.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="simapp">SimApp<a href="#simapp" class="hash-link" aria-label="Direct link to SimApp" title="Direct link to SimApp">​</a></h3><p>In this section we describe the changes made in Cosmos SDK&#x27; SimApp.
<strong>These changes are directly applicable to your application wiring.</strong>
Please read this section first, but for an exhaustive list of changes, refer to the <a href="https://github.com/cosmos/cosmos-sdk/blob/main/simapp/CHANGELOG.md" target="_blank" rel="noopener noreferrer">CHANGELOG</a>.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="client-rootgo">Client (<code>root.go</code>)<a href="#client-rootgo" class="hash-link" aria-label="Direct link to client-rootgo" title="Direct link to client-rootgo">​</a></h4><p>The <code>client</code> package has been refactored to make use of the address codecs (address, validator address, consensus address, etc.)
and address bech32 prefixes (address and validator address).
This is part of the work of abstracting the SDK from the global bech32 config.</p><p>This means the address codecs and prefixes must be provided in the <code>client.Context</code> in the application client (usually <code>root.go</code>).</p><div class="language-diff codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-diff codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">clientCtx = clientCtx.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token inserted-sign inserted prefix inserted" style="color:#36acaa">+</span><span class="token inserted-sign inserted line" style="color:#36acaa"> WithAddressCodec(addressCodec).</span><br></span><span class="token-line" style="color:#393A34"><span class="token inserted-sign inserted line" style="color:#36acaa"></span><span class="token inserted-sign inserted prefix inserted" style="color:#36acaa">+</span><span class="token inserted-sign inserted line" style="color:#36acaa"> WithValidatorAddressCodec(validatorAddressCodec).</span><br></span><span class="token-line" style="color:#393A34"><span class="token inserted-sign inserted line" style="color:#36acaa"></span><span class="token inserted-sign inserted prefix inserted" style="color:#36acaa">+</span><span class="token inserted-sign inserted line" style="color:#36acaa"> WithConsensusAddressCodec(consensusAddressCodec).</span><br></span><span class="token-line" style="color:#393A34"><span class="token inserted-sign inserted line" style="color:#36acaa"></span><span class="token inserted-sign inserted prefix inserted" style="color:#36acaa">+</span><span class="token inserted-sign inserted line" style="color:#36acaa"> WithAddressPrefix(&quot;cosmos&quot;).</span><br></span><span class="token-line" style="color:#393A34"><span class="token inserted-sign inserted line" style="color:#36acaa"></span><span class="token inserted-sign inserted prefix inserted" style="color:#36acaa">+</span><span class="token inserted-sign inserted line" style="color:#36acaa"> WithValidatorPrefix(&quot;cosmosvaloper&quot;)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>When using <code>depinject</code> / <code>app_di</code>, the client codecs can be provided directly from application config.</strong></p><p>Refer to SimApp <code>root_di.go</code> and <code>root.go</code> for an example with an app di and a legacy app.</p><p>Additionally, a simplification of the start command leads to the following change:</p><div class="language-diff codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-diff codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token deleted-sign deleted prefix deleted" style="color:#d73a49">-</span><span class="token deleted-sign deleted line" style="color:#d73a49"> server.AddCommands(rootCmd, newApp, func(startCmd *cobra.Command) {})</span><br></span><span class="token-line" style="color:#393A34"><span class="token deleted-sign deleted line" style="color:#d73a49"></span><span class="token inserted-sign inserted prefix inserted" style="color:#36acaa">+</span><span class="token inserted-sign inserted line" style="color:#36acaa"> server.AddCommands(rootCmd, newApp, server.StartCmdOptions[servertypes.Application]{})</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="server-appgo">Server (<code>app.go</code>)<a href="#server-appgo" class="hash-link" aria-label="Direct link to server-appgo" title="Direct link to server-appgo">​</a></h4><h5 class="anchor anchorWithStickyNavbar_LWe7" id="module-manager">Module Manager<a href="#module-manager" class="hash-link" aria-label="Direct link to Module Manager" title="Direct link to Module Manager">​</a></h5><p>The basic module manager has been deleted. It was not necessary anymore and was simplified to use the <code>module.Manager</code> directly.
It can be removed from your <code>app.go</code>.</p><p>For depinject users, it isn&#x27;t necessary anymore to supply a <code>map[string]module.AppModuleBasic</code> for customizing the app module basic instantiation.
The custom parameters (such as genutil message validator or gov proposal handler, or evidence handler) can directly be supplied.
When requiring a module manager in <code>root.go</code>, inject <code>*module.Manager</code> using <code>depinject.Inject</code>. </p><p>For non depinject users, simply call <code>RegisterLegacyAminoCodec</code> and <code>RegisterInterfaces</code> on the module manager:</p><div class="language-diff codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-diff codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token deleted-sign deleted prefix deleted" style="color:#d73a49">-</span><span class="token deleted-sign deleted line" style="color:#d73a49">app.BasicModuleManager = module.NewBasicManagerFromManager(...)</span><br></span><span class="token-line" style="color:#393A34"><span class="token deleted-sign deleted line" style="color:#d73a49"></span><span class="token deleted-sign deleted prefix deleted" style="color:#d73a49">-</span><span class="token deleted-sign deleted line" style="color:#d73a49">app.BasicModuleManager.RegisterLegacyAminoCodec(legacyAmino)</span><br></span><span class="token-line" style="color:#393A34"><span class="token deleted-sign deleted line" style="color:#d73a49"></span><span class="token deleted-sign deleted prefix deleted" style="color:#d73a49">-</span><span class="token deleted-sign deleted line" style="color:#d73a49">app.BasicModuleManager.RegisterInterfaces(interfaceRegistry)</span><br></span><span class="token-line" style="color:#393A34"><span class="token deleted-sign deleted line" style="color:#d73a49"></span><span class="token inserted-sign inserted prefix inserted" style="color:#36acaa">+</span><span class="token inserted-sign inserted line" style="color:#36acaa">app.ModuleManager.RegisterLegacyAminoCodec(legacyAmino)</span><br></span><span class="token-line" style="color:#393A34"><span class="token inserted-sign inserted line" style="color:#36acaa"></span><span class="token inserted-sign inserted prefix inserted" style="color:#36acaa">+</span><span class="token inserted-sign inserted line" style="color:#36acaa">app.ModuleManager.RegisterInterfaces(interfaceRegistry)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Additionally, thanks to the genesis simplification, as explained in <a href="#genesis-interface">the genesis interface update</a>, the module manager <code>InitGenesis</code> and <code>ExportGenesis</code> methods do not require the codec anymore.</p><h5 class="anchor anchorWithStickyNavbar_LWe7" id="grpc-web">gRPC Web<a href="#grpc-web" class="hash-link" aria-label="Direct link to gRPC Web" title="Direct link to gRPC Web">​</a></h5><p>Grpc-web embedded client has been removed from the server. If you would like to use grpc-web, you can use the <a href="https://www.envoyproxy.io/docs/envoy/latest/start/start" target="_blank" rel="noopener noreferrer">envoy proxy</a>. Here&#x27;s how to set it up:</p><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Step by step guide</summary><div><div class="collapsibleContent_i85q"><ol><li><p>Install Envoy following the <a href="https://www.envoyproxy.io/docs/envoy/latest/start/install" target="_blank" rel="noopener noreferrer">official installation guide</a>.</p></li><li><p>Create an Envoy configuration file named <code>envoy.yaml</code> with the following content:</p><div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">static_resources</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">listeners</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> listener_0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">address</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">socket_address</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">address</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> 0.0.0.0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">port_value</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">8080</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">filter_chains</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">filters</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> envoy.filters.network.http_connection_manager</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">typed_config</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">&quot;@type&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> type.googleapis.com/envoy.extensions.filters.network.http_connection_manager.v3.HttpConnectionManager</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">codec_type</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> auto</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">stat_prefix</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> ingress_http</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">route_config</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> local_route</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token key atrule" style="color:#00a4db">virtual_hosts</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> local_service</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token key atrule" style="color:#00a4db">domains</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;*&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token key atrule" style="color:#00a4db">routes</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">match</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">prefix</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;/&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token key atrule" style="color:#00a4db">route</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token key atrule" style="color:#00a4db">cluster</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> grpc_service</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token key atrule" style="color:#00a4db">timeout</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> 0s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token key atrule" style="color:#00a4db">max_stream_duration</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    </span><span class="token key atrule" style="color:#00a4db">grpc_timeout_header_max</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> 0s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token key atrule" style="color:#00a4db">cors</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token key atrule" style="color:#00a4db">allow_origin_string_match</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">prefix</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;*&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token key atrule" style="color:#00a4db">allow_methods</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> GET</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> PUT</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> DELETE</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> POST</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> OPTIONS</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token key atrule" style="color:#00a4db">allow_headers</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> keep</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">alive</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">user</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">agent</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">cache</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">control</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">content</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">type</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">content</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">transfer</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">encoding</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">custom</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">header</span><span class="token punctuation" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">x</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">accept</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">content</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">transfer</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">encoding</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">x</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">accept</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">response</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">streaming</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">x</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">user</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">agent</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">x</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">grpc</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">web</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">grpc</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">timeout</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token key atrule" style="color:#00a4db">max_age</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;1728000&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token key atrule" style="color:#00a4db">expose_headers</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> custom</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">header</span><span class="token punctuation" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">grpc</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">status</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">grpc</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">message</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">http_filters</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> envoy.filters.http.grpc_web</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token key atrule" style="color:#00a4db">typed_config</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token key atrule" style="color:#00a4db">&quot;@type&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> type.googleapis.com/envoy.extensions.filters.http.grpc_web.v3.GrpcWeb</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> envoy.filters.http.cors</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token key atrule" style="color:#00a4db">typed_config</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token key atrule" style="color:#00a4db">&quot;@type&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> type.googleapis.com/envoy.extensions.filters.http.cors.v3.Cors</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> envoy.filters.http.router</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token key atrule" style="color:#00a4db">typed_config</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token key atrule" style="color:#00a4db">&quot;@type&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> type.googleapis.com/envoy.extensions.filters.http.router.v3.Router</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">clusters</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> grpc_service</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">connect_timeout</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> 0.25s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">type</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> logical_dns</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">http2_protocol_options</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">lb_policy</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> round_robin</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">load_assignment</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">cluster_name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> cluster_0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">endpoints</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">lb_endpoints</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">endpoint</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token key atrule" style="color:#00a4db">address</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token key atrule" style="color:#00a4db">socket_address</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    </span><span class="token key atrule" style="color:#00a4db">address</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> 0.0.0.0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    </span><span class="token key atrule" style="color:#00a4db">port_value</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">9090</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>This configuration tells Envoy to listen on port 8080 and forward requests to your gRPC service on port 9090. Note that this configuration is a starting point and can be modified according to your specific needs and preferences. You may need to adjust ports, addresses, or add additional settings based on your particular setup and requirements.</p></li><li><p>Start your Cosmos SDK application, ensuring it&#x27;s configured to serve gRPC on port 9090.</p></li><li><p>Start Envoy with the configuration file:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">envoy -c envoy.yaml</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p>If Envoy starts successfully, you should see output similar to this:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">2024</span><span class="token plain">-08-29 </span><span class="token number" style="color:#36acaa">10</span><span class="token plain">:47:08.753</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">6281320</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">info</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">config</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">source/common/listener_manager/listener_manager_impl.cc:930</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> all dependencies initialized. starting workers</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">2024</span><span class="token plain">-08-29 </span><span class="token number" style="color:#36acaa">10</span><span class="token plain">:47:08.754</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">6281320</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">info</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">main</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">source/server/server.cc:978</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> starting main dispatch loop</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>This indicates that Envoy has started and is ready to proxy requests.</p></li><li><p>Update your client applications to connect to Envoy (http://localhost:8080 by default).</p></li></ol></div></div></details><p>By following these steps, Envoy will handle the translation between gRPC-Web and gRPC, allowing your existing gRPC-Web clients to continue functioning without modifications to your Cosmos SDK application.</p><p>To test the setup, you can use a tool like <a href="https://github.com/fullstorydev/grpcurl" target="_blank" rel="noopener noreferrer">grpcurl</a>. For example:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">grpcurl -plaintext localhost:8080 cosmos.base.tendermint.v1beta1.Service/GetLatestBlock</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h5 class="anchor anchorWithStickyNavbar_LWe7" id="antehandlers">AnteHandlers<a href="#antehandlers" class="hash-link" aria-label="Direct link to AnteHandlers" title="Direct link to AnteHandlers">​</a></h5><p>The <code>GasConsumptionDecorator</code> and <code>IncreaseSequenceDecorator</code> have been merged with the SigVerificationDecorator, so you&#x27;ll
need to remove them both from your app.go code, they will yield to unresolvable symbols when compiling.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="unordered-transactions">Unordered Transactions<a href="#unordered-transactions" class="hash-link" aria-label="Direct link to Unordered Transactions" title="Direct link to Unordered Transactions">​</a></h4><p>The Cosmos SDK now supports unordered transactions. This means that transactions
can be executed in any order and doesn&#x27;t require the client to deal with or manage
nonces. This also means the order of execution is not guaranteed.</p><p>Unordered transactions are automatically enabled when using <code>depinject</code> / app di, simply supply the <code>servertypes.AppOptions</code> in <code>app.go</code>:</p><div class="language-diff codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-diff codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">   depinject.Supply(</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token inserted-sign inserted prefix inserted" style="color:#36acaa">+</span><span class="token inserted-sign inserted line" style="color:#36acaa">       // supply the application options</span><br></span><span class="token-line" style="color:#393A34"><span class="token inserted-sign inserted line" style="color:#36acaa"></span><span class="token inserted-sign inserted prefix inserted" style="color:#36acaa">+</span><span class="token inserted-sign inserted line" style="color:#36acaa">       appOpts,</span><br></span><span class="token-line" style="color:#393A34"><span class="token inserted-sign inserted line" style="color:#36acaa"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">       // supply the logger</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">       logger,</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">   )</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Step-by-step Wiring </summary><div><div class="collapsibleContent_i85q">If you are still using the legacy wiring, you must enable unordered transactions manually:<ul><li><p>Update the <code>App</code> constructor to create, load, and save the unordered transaction
manager.</p><div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">func</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">NewApp</span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">...</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">App </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// create, start, and load the unordered tx manager</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    utxDataDir </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> filepath</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Join</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">cast</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">ToString</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">appOpts</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Get</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">flags</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">FlagHome</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;data&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    app</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">UnorderedTxManager </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> unorderedtx</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">NewManager</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">utxDataDir</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    app</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">UnorderedTxManager</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Start</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> err </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> app</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">UnorderedTxManager</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">OnInit</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> err </span><span class="token operator" style="color:#393A34">!=</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">nil</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">panic</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">fmt</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Errorf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;failed to initialize unordered tx manager: %w&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> err</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p>Add the decorator to the existing AnteHandler chain, which should be as early
as possible.</p><div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">anteDecorators </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">sdk</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">AnteDecorator</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ante</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">NewSetUpContextDecorator</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ante</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">NewUnorderedTxDecorator</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">unorderedtx</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">DefaultMaxTimeoutDuration</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> options</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">TxManager</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> options</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Environment</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> sdk</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">ChainAnteDecorators</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">anteDecorators</span><span class="token operator" style="color:#393A34">...</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">nil</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p>If the App has a SnapshotManager defined, you must also register the extension
for the TxManager.</p><div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> manager </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> app</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">SnapshotManager</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> manager </span><span class="token operator" style="color:#393A34">!=</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">nil</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    err </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> manager</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">RegisterExtensions</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">unorderedtx</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">NewSnapshotter</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">app</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">UnorderedTxManager</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> err </span><span class="token operator" style="color:#393A34">!=</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">nil</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">panic</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">fmt</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Errorf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;failed to register snapshot extension: %s&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> err</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p>Create or update the App&#x27;s <code>Preblocker()</code> method to call the unordered tx
manager&#x27;s <code>OnNewBlock()</code> method.</p><div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token operator" style="color:#393A34">...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">app</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">SetPreblocker</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">app</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">PreBlocker</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">func</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">app </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">SimApp</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">PreBlocker</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ctx sdk</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Context</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> req </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">abci</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">RequestFinalizeBlock</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">*</span><span class="token plain">sdk</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">ResponsePreBlock</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token builtin">error</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    app</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">UnorderedTxManager</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">OnNewBlock</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ctx</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">BlockTime</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> app</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">ModuleManager</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">PreBlock</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ctx</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> req</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p>Create or update the App&#x27;s <code>Close()</code> method to close the unordered tx manager.
Note, this is critical as it ensures the manager&#x27;s state is written to file
such that when the node restarts, it can recover the state to provide replay
protection.</p><div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">func</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">app </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">App</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">Close</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token builtin">error</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// close the unordered tx manager</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> e </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> app</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">UnorderedTxManager</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Close</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> e </span><span class="token operator" style="color:#393A34">!=</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">nil</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        err </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> errors</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Join</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">err</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> e</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> err</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li></ul></div></div></details><p>To submit an unordered transaction, the client must set the <code>unordered</code> flag to
<code>true</code> and ensure a reasonable <code>timeout_height</code> is set. The <code>timeout_height</code> is
used as a TTL for the transaction and is used to provide replay protection. See
<a href="https://github.com/cosmos/cosmos-sdk/blob/main/docs/architecture/adr-070-unordered-transactions.md" target="_blank" rel="noopener noreferrer">ADR-070</a>
for more details.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="sign-mode-textual">Sign Mode Textual<a href="#sign-mode-textual" class="hash-link" aria-label="Direct link to Sign Mode Textual" title="Direct link to Sign Mode Textual">​</a></h4><p>With the split of <code>x/auth/tx/config</code> in two (x/auth/tx/config as depinject module for txconfig and tx options) and <code>x/validate</code>, sign mode textual is no more automatically configured when using runtime (it was previously the case).
For the same instructions than for legacy app wiring to enable sign mode textual (see in v0.50 UPGRADING documentation).</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="depinject-app_configgo--appyml">Depinject <code>app_config.go</code> / <code>app.yml</code><a href="#depinject-app_configgo--appyml" class="hash-link" aria-label="Direct link to depinject-app_configgo--appyml" title="Direct link to depinject-app_configgo--appyml">​</a></h3><p>With the introduction of <a href="#core-api">environment in modules</a>, depinject automatically creates the environment for all modules.
Learn more about environment <a href="https://example.com" target="_blank" rel="noopener noreferrer">here</a> <!-- -->. Given the fields of environment, this means runtime creates a kv store service for all modules by default. It can happen that some modules do not have a store necessary (such as <code>x/auth/tx</code> for instance). In this case, the store creation should be skipped in <code>app_config.go</code>:</p><div class="language-diff codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-diff codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">InitGenesis: []string{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">   &quot;...&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token plain">},</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token inserted-sign inserted prefix inserted" style="color:#36acaa">+</span><span class="token inserted-sign inserted line" style="color:#36acaa"> // SkipStoreKeys is an optional list of store keys to skip when constructing the</span><br></span><span class="token-line" style="color:#393A34"><span class="token inserted-sign inserted line" style="color:#36acaa"></span><span class="token inserted-sign inserted prefix inserted" style="color:#36acaa">+</span><span class="token inserted-sign inserted line" style="color:#36acaa"> // module&#x27;s keeper. This is useful when a module does not have a store key.</span><br></span><span class="token-line" style="color:#393A34"><span class="token inserted-sign inserted line" style="color:#36acaa"></span><span class="token inserted-sign inserted prefix inserted" style="color:#36acaa">+</span><span class="token inserted-sign inserted line" style="color:#36acaa"> SkipStoreKeys: []string{</span><br></span><span class="token-line" style="color:#393A34"><span class="token inserted-sign inserted line" style="color:#36acaa"></span><span class="token inserted-sign inserted prefix inserted" style="color:#36acaa">+</span><span class="token inserted-sign inserted line" style="color:#36acaa">   &quot;tx&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token inserted-sign inserted line" style="color:#36acaa"></span><span class="token inserted-sign inserted prefix inserted" style="color:#36acaa">+</span><span class="token inserted-sign inserted line" style="color:#36acaa"> },</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="protobuf">Protobuf<a href="#protobuf" class="hash-link" aria-label="Direct link to Protobuf" title="Direct link to Protobuf">​</a></h3><p>The <code>cosmossdk.io/api/tendermint</code> package has been removed as CometBFT now publishes its protos to <code>buf.build/tendermint</code> and <code>buf.build/cometbft</code>.
There is no longer a need for the Cosmos SDK to host these protos for itself and its dependencies.
That package containing proto v2 generated code, but the SDK now uses <a href="https://buf.build/docs/bsr/generated-sdks/go" target="_blank" rel="noopener noreferrer">buf generated go SDK instead</a>.
If you were depending on <code>cosmossdk.io/api/tendermint</code>, please use the buf generated go SDK instead, or ask CometBFT host the generated proto v2 code.</p><p>The <code>codectypes.Any</code> has moved to <code>github.com/cosmos/gogoproto/types/any</code>. Module developers need to update the <code>buf.gen.gogo.yaml</code> configuration files by adjusting the corresponding <code>opt</code> option to <code>Mgoogle/protobuf/any.proto=github.com/cosmos/gogoproto/types/any</code> for directly mapping the<code>Any</code> type to its new location:</p><div class="language-diff codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-diff codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">version: v1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">plugins:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line"> - name: gocosmos</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">   out: ..</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token deleted-sign deleted prefix deleted" style="color:#d73a49">-</span><span class="token deleted-sign deleted line" style="color:#d73a49">    opt: plugins=grpc,Mgoogle/protobuf/any.proto=github.com/cosmos/cosmos-sdk/codec/types,Mcosmos/orm/v1/orm.proto=cosmossdk.io/orm</span><br></span><span class="token-line" style="color:#393A34"><span class="token deleted-sign deleted line" style="color:#d73a49"></span><span class="token inserted-sign inserted prefix inserted" style="color:#36acaa">+</span><span class="token inserted-sign inserted line" style="color:#36acaa">    opt: plugins=grpc,Mgoogle/protobuf/any.proto=github.com/cosmos/gogoproto/types/any,Mcosmos/orm/v1/orm.proto=cosmossdk.io/orm</span><br></span><span class="token-line" style="color:#393A34"><span class="token inserted-sign inserted line" style="color:#36acaa"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line"> - name: grpc-gateway</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">   out: ..</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">   opt: logtostderr=true,allow_colon_final_segments=true</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Also, any usages of the interfaces <code>AnyUnpacker</code> and <code>UnpackInterfacesMessage</code> must be replaced with the interfaces of the same name in the <code>github.com/cosmos/gogoproto/types/any</code> package.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="modules">Modules<a href="#modules" class="hash-link" aria-label="Direct link to Modules" title="Direct link to Modules">​</a></h3><h4 class="anchor anchorWithStickyNavbar_LWe7" id="all"><code>**all**</code><a href="#all" class="hash-link" aria-label="Direct link to all" title="Direct link to all">​</a></h4><p>All modules (expect <code>auth</code>) were spun out into their own <code>go.mod</code>. Replace their imports by <code>cosmossdk.io/x/{moduleName}</code>.</p><h5 class="anchor anchorWithStickyNavbar_LWe7" id="core-api">Core API<a href="#core-api" class="hash-link" aria-label="Direct link to Core API" title="Direct link to Core API">​</a></h5><p>Core API has been introduced for modules since v0.47. With the deprecation of <code>sdk.Context</code>, we strongly recommend to use the <code>cosmossdk.io/core/appmodule</code> interfaces for the modules. This will allow the modules to work out of the box with server/v2 and baseapp, as well as limit their dependencies on the SDK.</p><p>Additionally, the <code>appmodule.Environment</code> struct is introduced to fetch different services from the application.
This should be used as an alternative to using <code>sdk.UnwrapContext(ctx)</code> to fetch the services.
It needs to be passed into a module at instantiation (or depinject will inject the correct environment). </p><p><code>x/circuit</code> is used as an example:</p><div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">app</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">CircuitKeeper </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> circuitkeeper</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">NewKeeper</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">runtime</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">NewEnvironment</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">runtime</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">NewKVStoreService</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">keys</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">circuittypes</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">StoreKey</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> logger</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">With</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">log</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">ModuleKey</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;x/circuit&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> appCodec</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> authtypes</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">NewModuleAddress</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">govtypes</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">ModuleName</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">String</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> app</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">AuthKeeper</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">AddressCodec</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>If your module requires a message server or query server, it should be passed in the environment as well.</p><div class="language-diff codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-diff codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token deleted-sign deleted prefix deleted" style="color:#d73a49">-</span><span class="token deleted-sign deleted line" style="color:#d73a49">govKeeper := govkeeper.NewKeeper(appCodec, runtime.NewKVStoreService(keys[govtypes.StoreKey]), app.AuthKeeper, app.BankKeeper,app.StakingKeeper, app.PoolKeeper, app.MsgServiceRouter(), govConfig, authtypes.NewModuleAddress(govtypes.ModuleName).String())</span><br></span><span class="token-line" style="color:#393A34"><span class="token deleted-sign deleted line" style="color:#d73a49"></span><span class="token inserted-sign inserted prefix inserted" style="color:#36acaa">+</span><span class="token inserted-sign inserted line" style="color:#36acaa">govKeeper := govkeeper.NewKeeper(appCodec, runtime.NewEnvironment(runtime.NewKVStoreService(keys[govtypes.StoreKey]), logger.With(log.ModuleKey, &quot;x/circuit&quot;), runtime.EnvWithMsgRouterService(app.MsgServiceRouter()), runtime.EnvWithQueryRouterService(app.GRPCQueryRouter())), app.AuthKeeper, app.BankKeeper, app.StakingKeeper, app.PoolKeeper, govConfig, authtypes.NewModuleAddress(govtypes.ModuleName).String())</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The signature of the extension interface <code>HasRegisterInterfaces</code> has been changed to accept a <code>cosmossdk.io/core/registry.InterfaceRegistrar</code> instead of a <code>codec.InterfaceRegistry</code>.   <code>HasRegisterInterfaces</code> is now a part of <code>cosmossdk.io/core/appmodule</code>.  Modules should update their <code>HasRegisterInterfaces</code> implementation to accept a <code>cosmossdk.io/core/registry.InterfaceRegistrar</code> interface.</p><div class="language-diff codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-diff codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token deleted-sign deleted prefix deleted" style="color:#d73a49">-</span><span class="token deleted-sign deleted line" style="color:#d73a49">func (AppModule) RegisterInterfaces(registry codectypes.InterfaceRegistry) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token deleted-sign deleted line" style="color:#d73a49"></span><span class="token inserted-sign inserted prefix inserted" style="color:#36acaa">+</span><span class="token inserted-sign inserted line" style="color:#36acaa">func (AppModule) RegisterInterfaces(registry registry.InterfaceRegistrar) {</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The signature of the extension interface <code>HasAminoCodec</code> has been changed to accept a <code>cosmossdk.io/core/registry.AminoRegistrar</code> instead of a <code>codec.LegacyAmino</code>. Modules should update their <code>HasAminoCodec</code> implementation to accept a <code>cosmossdk.io/core/registry.AminoRegistrar</code> interface.</p><div class="language-diff codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-diff codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token deleted-sign deleted prefix deleted" style="color:#d73a49">-</span><span class="token deleted-sign deleted line" style="color:#d73a49">func (AppModule) RegisterLegacyAminoCodec(cdc *codec.LegacyAmino) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token deleted-sign deleted line" style="color:#d73a49"></span><span class="token inserted-sign inserted prefix inserted" style="color:#36acaa">+</span><span class="token inserted-sign inserted line" style="color:#36acaa">func (AppModule) RegisterLegacyAminoCodec(registrar registry.AminoRegistrar) {</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h5 class="anchor anchorWithStickyNavbar_LWe7" id="simulation">Simulation<a href="#simulation" class="hash-link" aria-label="Direct link to Simulation" title="Direct link to Simulation">​</a></h5><p><code>MsgSimulatorFn</code> has been updated to return an error. Its context argument has been removed, and an address.Codec has
been added to avoid the use of the Accounts.String() method.</p><div class="language-diff codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-diff codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token deleted-sign deleted prefix deleted" style="color:#d73a49">-</span><span class="token deleted-sign deleted line" style="color:#d73a49">type MsgSimulatorFn func(r *rand.Rand, ctx sdk.Context, accs []Account) sdk.Msg</span><br></span><span class="token-line" style="color:#393A34"><span class="token deleted-sign deleted line" style="color:#d73a49"></span><span class="token inserted-sign inserted prefix inserted" style="color:#36acaa">+</span><span class="token inserted-sign inserted line" style="color:#36acaa">type MsgSimulatorFn func(r *rand.Rand, accs []Account, cdc address.Codec) (sdk.Msg, error)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h5 class="anchor anchorWithStickyNavbar_LWe7" id="depinject">Depinject<a href="#depinject" class="hash-link" aria-label="Direct link to Depinject" title="Direct link to Depinject">​</a></h5><p>Previously <code>cosmossdk.io/core</code> held functions <code>Invoke</code>, <code>Provide</code> and <code>Register</code> were moved to <code>cosmossdk.io/depinject/appconfig</code>.
All modules using dependency injection must update their imports.</p><h5 class="anchor anchorWithStickyNavbar_LWe7" id="params">Params<a href="#params" class="hash-link" aria-label="Direct link to Params" title="Direct link to Params">​</a></h5><p>Previous module migrations have been removed. It is required to migrate to v0.50 prior to upgrading to v0.52 for not missing any module migrations.</p><h5 class="anchor anchorWithStickyNavbar_LWe7" id="genesis-interface">Genesis Interface<a href="#genesis-interface" class="hash-link" aria-label="Direct link to Genesis Interface" title="Direct link to Genesis Interface">​</a></h5><p>All genesis interfaces have been migrated to take <code>context.Context</code> instead of <code>sdk.Context</code>.
Secondly, the codec is no longer passed in by the framework. The codec is now passed in by the module.
Lastly, all InitGenesis and ExportGenesis functions now return an error.</p><div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// InitGenesis performs genesis initialization for the module.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">func</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">am AppModule</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">InitGenesis</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ctx context</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Context</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> data json</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">RawMessage</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token builtin">error</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// ExportGenesis returns the exported genesis state as raw bytes for the module.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">func</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">am AppModule</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">ExportGenesis</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ctx context</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Context</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">json</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">RawMessage</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token builtin">error</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h5 class="anchor anchorWithStickyNavbar_LWe7" id="migration-to-collections">Migration to Collections<a href="#migration-to-collections" class="hash-link" aria-label="Direct link to Migration to Collections" title="Direct link to Migration to Collections">​</a></h5><p>Most of Cosmos SDK modules have migrated to <a href="https://docs.cosmos.network/main/build/packages/collections" target="_blank" rel="noopener noreferrer">collections</a>.
Many functions have been removed due to this changes as the API can be smaller thanks to collections.
For modules that have migrated, verify you are checking against <code>collections.ErrNotFound</code> when applicable.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="xauth"><code>x/auth</code><a href="#xauth" class="hash-link" aria-label="Direct link to xauth" title="Direct link to xauth">​</a></h4><p>Vesting accounts messages (and CLIs) have been removed. Existing vesting accounts will keep working but no new vesting accounts can be created.
Use <code>x/accounts</code> lockup accounts or implement an <code>x/accounts</code> vesting account instead.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="xaccounts"><code>x/accounts</code><a href="#xaccounts" class="hash-link" aria-label="Direct link to xaccounts" title="Direct link to xaccounts">​</a></h4><p>Accounts&#x27;s AccountNumber will be used as a global account number tracking replacing Auth legacy AccountNumber. Must set accounts&#x27;s AccountNumber with auth&#x27;s AccountNumber value in upgrade handler. This is done through auth keeper MigrateAccountNumber function.</p><div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> authkeeper </span><span class="token string" style="color:#e3116c">&quot;github.com/cosmos/cosmos-sdk/x/auth/keeper&quot;</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">err </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> authkeeper</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">MigrateAccountNumberUnsafe</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ctx</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain">app</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">AuthKeeper</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> err </span><span class="token operator" style="color:#393A34">!=</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">nil</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">nil</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> err</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="xcrisis"><code>x/crisis</code><a href="#xcrisis" class="hash-link" aria-label="Direct link to xcrisis" title="Direct link to xcrisis">​</a></h4><p>The <code>x/crisis</code> module was removed due to it not being supported or functional any longer. </p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="xdistribution"><code>x/distribution</code><a href="#xdistribution" class="hash-link" aria-label="Direct link to xdistribution" title="Direct link to xdistribution">​</a></h4><p>Existing chains using <code>x/distribution</code> module must add the new <code>x/protocolpool</code> module.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="xgov"><code>x/gov</code><a href="#xgov" class="hash-link" aria-label="Direct link to xgov" title="Direct link to xgov">​</a></h4><p>Gov v1beta1 proposal handler has been changed to take in a <code>context.Context</code> instead of <code>sdk.Context</code>.
This change was made to allow legacy proposals to be compatible with server/v2.
If you wish to migrate to server/v2, you should update your proposal handler to take in a <code>context.Context</code> and use services.
On the other hand, if you wish to keep using baseapp, simply unwrap the sdk context in your proposal handler.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="xprotocolpool"><code>x/protocolpool</code><a href="#xprotocolpool" class="hash-link" aria-label="Direct link to xprotocolpool" title="Direct link to xprotocolpool">​</a></h4><p>Introducing a new <code>x/protocolpool</code> module to handle community pool funds. Its store must be added while upgrading to v0.52.x.</p><p>Example:</p><div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">func</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">app SimApp</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">RegisterUpgradeHandlers</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    app</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">UpgradeKeeper</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">SetUpgradeHandler</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        UpgradeName</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">func</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ctx sdk</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Context</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">_</span><span class="token plain"> upgradetypes</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Plan</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> fromVM module</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">VersionMap</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">module</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">VersionMap</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token builtin">error</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> app</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">ModuleManager</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">RunMigrations</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ctx</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> app</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Configurator</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> fromVM</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Add <code>x/protocolpool</code> store while upgrading to v0.52.x:</p><div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">storetypes</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">StoreUpgrades</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Added</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token builtin">string</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                protocolpooltypes</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">ModuleName</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="xvalidate"><code>x/validate</code><a href="#xvalidate" class="hash-link" aria-label="Direct link to xvalidate" title="Direct link to xvalidate">​</a></h4><p>Introducing <code>x/validate</code> a module that is solely used for registering default ante/post handlers and global tx validators when using runtime and runtime/v2. If you wish to set your custom ante/post handlers, no need to use this module.
You can however always extend them by adding extra tx validators (see <code>x/validate</code> documentation).</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="v050x"><a href="https://github.com/cosmos/cosmos-sdk/releases/tag/v0.50.0-alpha.0" target="_blank" rel="noopener noreferrer">v0.50.x</a><a href="#v050x" class="hash-link" aria-label="Direct link to v050x" title="Direct link to v050x">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="migration-to-cometbft-part-2">Migration to CometBFT (Part 2)<a href="#migration-to-cometbft-part-2" class="hash-link" aria-label="Direct link to Migration to CometBFT (Part 2)" title="Direct link to Migration to CometBFT (Part 2)">​</a></h3><p>The Cosmos SDK has migrated in its previous versions, to CometBFT.
Some functions have been renamed to reflect the naming change.</p><p>Following an exhaustive list:</p><ul><li><code>client.TendermintRPC</code> -&gt; <code>client.CometRPC</code></li><li><code>clitestutil.MockTendermintRPC</code> -&gt; <code>clitestutil.MockCometRPC</code></li><li><code>clitestutilgenutil.CreateDefaultTendermintConfig</code> -&gt; <code>clitestutilgenutil.CreateDefaultCometConfig</code></li><li>Package <code>client/grpc/tmservice</code> -&gt; <code>client/grpc/cmtservice</code></li></ul><p>Additionally, the commands and flags mentioning <code>tendermint</code> have been renamed to <code>comet</code>.
These commands and flags are still supported for backward compatibility.</p><p>For backward compatibility, the <code>**/tendermint/**</code> gRPC services are still supported.</p><p>Additionally, the SDK is starting its abstraction from CometBFT Go types through the codebase:</p><ul><li>The usage of the CometBFT logger has been replaced by the Cosmos SDK logger interface (<code>cosmossdk.io/log.Logger</code>).</li><li>The usage of <code>github.com/cometbft/cometbft/libs/bytes.HexByte</code> has been replaced by <code>[]byte</code>.</li><li>Usage of an application genesis (see <a href="#xgenutil">genutil</a>).</li></ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="enable-vote-extensions">Enable Vote Extensions<a href="#enable-vote-extensions" class="hash-link" aria-label="Direct link to Enable Vote Extensions" title="Direct link to Enable Vote Extensions">​</a></h4><div class="theme-admonition theme-admonition-tip alert alert--success admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</div><div class="admonitionContent_S0QG"><p>This is an optional feature that is disabled by default.</p></div></div><p>Once all the code changes required to implement Vote Extensions are in place,
they can be enabled by setting the consensus param <code>Abci.VoteExtensionsEnableHeight</code>
to a value greater than zero.</p><p>In a new chain, this can be done in the <code>genesis.json</code> file.</p><p>For existing chains this can be done in two ways:</p><ul><li>During an upgrade the value is set in an upgrade handler.</li><li>A governance proposal that changes the consensus param <strong>after a coordinated upgrade has taken place</strong>.</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="baseapp-1">BaseApp<a href="#baseapp-1" class="hash-link" aria-label="Direct link to BaseApp" title="Direct link to BaseApp">​</a></h3><p>All ABCI methods now accept a pointer to the request and response types defined
by CometBFT. In addition, they also return errors. An ABCI method should only
return errors in cases where a catastrophic failure has occurred and the application
should halt. However, this is abstracted away from the application developer. Any
handler that an application can define or set that returns an error, will gracefully
by handled by <code>BaseApp</code> on behalf of the application.</p><p>BaseApp calls of <code>BeginBlock</code> &amp; <code>Endblock</code> are now private but are still exposed
to the application to define via the <code>Manager</code> type. <code>FinalizeBlock</code> is public
and should be used in order to test and run operations. This means that although
<code>BeginBlock</code> &amp; <code>Endblock</code> no longer exist in the ABCI interface, they are automatically
called by <code>BaseApp</code> during <code>FinalizeBlock</code>. Specifically, the order of operations
is <code>BeginBlock</code> -&gt; <code>DeliverTx</code> (for all txs) -&gt; <code>EndBlock</code>.</p><p>ABCI++ 2.0 also brings <code>ExtendVote</code> and <code>VerifyVoteExtension</code> ABCI methods. These
methods allow applications to extend and verify pre-commit votes. The Cosmos SDK
allows an application to define handlers for these methods via <code>ExtendVoteHandler</code>
and <code>VerifyVoteExtensionHandler</code> respectively. Please see <a href="https://docs.cosmos.network/v0.50/build/abci/vote-extensions" target="_blank" rel="noopener noreferrer">here</a>
for more info.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="set-preblocker">Set PreBlocker<a href="#set-preblocker" class="hash-link" aria-label="Direct link to Set PreBlocker" title="Direct link to Set PreBlocker">​</a></h4><p>A <code>SetPreBlocker</code> method has been added to BaseApp. This is essential for BaseApp to run <code>PreBlock</code> which runs before begin blocker other modules, and allows to modify consensus parameters, and the changes are visible to the following state machine logics.
Read more about other use cases <a href="https://github.com/cosmos/cosmos-sdk/blob/main/docs/architecture/adr-068-preblock.md" target="_blank" rel="noopener noreferrer">here</a>.</p><p><code>depinject</code> / app di users need to add <code>x/upgrade</code> in their <code>app_config.go</code> / <code>app.yml</code>:</p><div class="language-diff codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-diff codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token inserted-sign inserted prefix inserted" style="color:#36acaa">+</span><span class="token inserted-sign inserted line" style="color:#36acaa"> PreBlockers: []string{</span><br></span><span class="token-line" style="color:#393A34"><span class="token inserted-sign inserted line" style="color:#36acaa"></span><span class="token inserted-sign inserted prefix inserted" style="color:#36acaa">+</span><span class="token inserted-sign inserted line" style="color:#36acaa">   upgradetypes.ModuleName,</span><br></span><span class="token-line" style="color:#393A34"><span class="token inserted-sign inserted line" style="color:#36acaa"></span><span class="token inserted-sign inserted prefix inserted" style="color:#36acaa">+</span><span class="token inserted-sign inserted line" style="color:#36acaa"> },</span><br></span><span class="token-line" style="color:#393A34"><span class="token inserted-sign inserted line" style="color:#36acaa"></span><span class="token plain">BeginBlockers: []string{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token deleted-sign deleted prefix deleted" style="color:#d73a49">-</span><span class="token deleted-sign deleted line" style="color:#d73a49">   upgradetypes.ModuleName,</span><br></span><span class="token-line" style="color:#393A34"><span class="token deleted-sign deleted line" style="color:#d73a49"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">   minttypes.ModuleName,</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>When using (legacy) application wiring, the following must be added to <code>app.go</code>:</p><div class="language-diff codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-diff codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token inserted-sign inserted prefix inserted" style="color:#36acaa">+</span><span class="token inserted-sign inserted line" style="color:#36acaa">app.ModuleManager.SetOrderPreBlockers(</span><br></span><span class="token-line" style="color:#393A34"><span class="token inserted-sign inserted line" style="color:#36acaa"></span><span class="token inserted-sign inserted prefix inserted" style="color:#36acaa">+</span><span class="token inserted-sign inserted line" style="color:#36acaa">   upgradetypes.ModuleName,</span><br></span><span class="token-line" style="color:#393A34"><span class="token inserted-sign inserted line" style="color:#36acaa"></span><span class="token inserted-sign inserted prefix inserted" style="color:#36acaa">+</span><span class="token inserted-sign inserted line" style="color:#36acaa">)</span><br></span><span class="token-line" style="color:#393A34"><span class="token inserted-sign inserted line" style="color:#36acaa"></span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">app.ModuleManager.SetOrderBeginBlockers(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token deleted-sign deleted prefix deleted" style="color:#d73a49">-</span><span class="token deleted-sign deleted line" style="color:#d73a49">   upgradetypes.ModuleName,</span><br></span><span class="token-line" style="color:#393A34"><span class="token deleted-sign deleted line" style="color:#d73a49"></span><span class="token plain">)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token inserted-sign inserted prefix inserted" style="color:#36acaa">+</span><span class="token inserted-sign inserted line" style="color:#36acaa"> app.SetPreBlocker(app.PreBlocker)</span><br></span><span class="token-line" style="color:#393A34"><span class="token inserted-sign inserted line" style="color:#36acaa"></span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// ... //</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token inserted-sign inserted prefix inserted" style="color:#36acaa">+</span><span class="token inserted-sign inserted line" style="color:#36acaa">func (app *SimApp) PreBlocker(ctx sdk.Context, req *abci.RequestFinalizeBlock) (*sdk.ResponsePreBlock, error) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token inserted-sign inserted line" style="color:#36acaa"></span><span class="token inserted-sign inserted prefix inserted" style="color:#36acaa">+</span><span class="token inserted-sign inserted line" style="color:#36acaa">   return app.ModuleManager.PreBlock(ctx, req)</span><br></span><span class="token-line" style="color:#393A34"><span class="token inserted-sign inserted line" style="color:#36acaa"></span><span class="token inserted-sign inserted prefix inserted" style="color:#36acaa">+</span><span class="token inserted-sign inserted line" style="color:#36acaa">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="events">Events<a href="#events" class="hash-link" aria-label="Direct link to Events" title="Direct link to Events">​</a></h4><p>The log section of <code>abci.TxResult</code> is not populated in the case of successful
msg(s) execution. Instead a new attribute is added to all messages indicating
the <code>msg_index</code> which identifies which events and attributes relate the same
transaction.</p><p><code>BeginBlock</code> &amp; <code>EndBlock</code> Events are now emitted through <code>FinalizeBlock</code> but have
an added attribute, <code>mode=BeginBlock|EndBlock</code>, to identify if the event belongs
to <code>BeginBlock</code> or <code>EndBlock</code>.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="config-files">Config files<a href="#config-files" class="hash-link" aria-label="Direct link to Config files" title="Direct link to Config files">​</a></h3><p>Confix is a new SDK tool for modifying and migrating configuration of the SDK.
It is the replacement of the <code>config.Cmd</code> command from the <code>client/config</code> package.</p><p>Use the following command to migrate your configuration:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">simd config migrate v0.50</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>If you were using <code>&lt;appd&gt; config [key]</code> or <code>&lt;appd&gt; config [key] [value]</code> to set and get values from the <code>client.toml</code>, replace it with <code>&lt;appd&gt; config get client [key]</code> and <code>&lt;appd&gt; config set client [key] [value]</code>. The extra verbosity is due to the extra functionalities added in config.</p><p>More information about <a href="https://docs.cosmos.network/main/build/tooling/confix" target="_blank" rel="noopener noreferrer">confix</a> and how to add it in your application binary in the <a href="https://docs.cosmos.network/main/build/tooling/confix" target="_blank" rel="noopener noreferrer">documentation</a>.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="grpc-web-1">gRPC-Web<a href="#grpc-web-1" class="hash-link" aria-label="Direct link to gRPC-Web" title="Direct link to gRPC-Web">​</a></h4><p>gRPC-Web is now listening to the same address and port as the gRPC Gateway API server (default: <code>localhost:1317</code>).
The possibility to listen to a different address has been removed, as well as its settings.
Use <code>confix</code> to clean-up your <code>app.toml</code>. A nginx (or alike) reverse-proxy can be set to keep the previous behavior.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="database-support">Database Support<a href="#database-support" class="hash-link" aria-label="Direct link to Database Support" title="Direct link to Database Support">​</a></h4><p>ClevelDB, BoltDB and BadgerDB are not supported anymore. To migrate from an unsupported database to a supported database please use a database migration tool.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="protobuf-1">Protobuf<a href="#protobuf-1" class="hash-link" aria-label="Direct link to Protobuf" title="Direct link to Protobuf">​</a></h3><p>With the deprecation of the Amino JSON codec defined in <a href="https://github.com/cosmos/gogoproto" target="_blank" rel="noopener noreferrer">cosmos/gogoproto</a> in favor of the protoreflect powered x/tx/aminojson codec, module developers are encouraged verify that their messages have the correct protobuf annotations to deterministically produce identical output from both codecs.</p><p>For core SDK types equivalence is asserted by generative testing of <a href="https://github.com/cosmos/cosmos-sdk/blob/v0.50.0-beta.0/tests/integration/rapidgen/rapidgen.go#L102" target="_blank" rel="noopener noreferrer">SignableTypes</a> in <a href="https://github.com/cosmos/cosmos-sdk/blob/v0.50.0-beta.0/tests/integration/tx/aminojson/aminojson_test.go#L94" target="_blank" rel="noopener noreferrer">TestAminoJSON_Equivalence</a>.</p><p>Read more about the available annotations <a href="https://docs.cosmos.network/v0.50/build/building-modules/protobuf-annotations" target="_blank" rel="noopener noreferrer">here</a>.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="stringer">Stringer<a href="#stringer" class="hash-link" aria-label="Direct link to Stringer" title="Direct link to Stringer">​</a></h4><p>The <code>gogoproto.goproto_stringer = false</code> annotation has been removed from most proto files. This means that the <code>String()</code> method is being generated for types that previously had this annotation. The generated <code>String()</code> method uses <code>proto.CompactTextString</code> for <em>stringifying</em> structs.
<a href="https://github.com/cosmos/cosmos-sdk/pull/13850#issuecomment-1328889651" target="_blank" rel="noopener noreferrer">Verify</a> the usage of the modified <code>String()</code> methods and double-check that they are not used in state-machine code.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="simapp-1">SimApp<a href="#simapp-1" class="hash-link" aria-label="Direct link to SimApp" title="Direct link to SimApp">​</a></h3><p>In this section we describe the changes made in Cosmos SDK&#x27; SimApp.
<strong>These changes are directly applicable to your application wiring.</strong></p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="module-assertions">Module Assertions<a href="#module-assertions" class="hash-link" aria-label="Direct link to Module Assertions" title="Direct link to Module Assertions">​</a></h4><p>Previously, all modules were required to be set in <code>OrderBeginBlockers</code>, <code>OrderEndBlockers</code> and <code>OrderInitGenesis / OrderExportGenesis</code> in <code>app.go</code> / <code>app_config.go</code>. This is no longer the case, the assertion has been loosened to only require modules implementing, respectively, the <code>appmodule.HasBeginBlocker</code>, <code>appmodule.HasEndBlocker</code> and <code>appmodule.HasGenesis</code> / <code>module.HasGenesis</code> interfaces.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="module-wiring">Module wiring<a href="#module-wiring" class="hash-link" aria-label="Direct link to Module wiring" title="Direct link to Module wiring">​</a></h4><p>The following modules <code>NewKeeper</code> function now take a <code>KVStoreService</code> instead of a <code>StoreKey</code>:</p><ul><li><code>x/auth</code></li><li><code>x/authz</code></li><li><code>x/bank</code></li><li><code>x/consensus</code></li><li><code>x/crisis</code></li><li><code>x/distribution</code></li><li><code>x/evidence</code></li><li><code>x/feegrant</code></li><li><code>x/gov</code></li><li><code>x/mint</code></li><li><code>x/nft</code></li><li><code>x/slashing</code></li><li><code>x/upgrade</code></li></ul><p><strong>Users using <code>depinject</code> / app di do not need any changes, this is abstracted for them.</strong></p><p>Users manually wiring their chain need to use the <code>runtime.NewKVStoreService</code> method to create a <code>KVStoreService</code> from a <code>StoreKey</code>:</p><div class="language-diff codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-diff codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">app.ConsensusParamsKeeper = consensusparamkeeper.NewKeeper(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line"> appCodec,</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token deleted-sign deleted prefix deleted" style="color:#d73a49">-</span><span class="token deleted-sign deleted line" style="color:#d73a49"> keys[consensusparamtypes.StoreKey]</span><br></span><span class="token-line" style="color:#393A34"><span class="token deleted-sign deleted line" style="color:#d73a49"></span><span class="token inserted-sign inserted prefix inserted" style="color:#36acaa">+</span><span class="token inserted-sign inserted line" style="color:#36acaa"> runtime.NewKVStoreService(keys[consensusparamtypes.StoreKey]),</span><br></span><span class="token-line" style="color:#393A34"><span class="token inserted-sign inserted line" style="color:#36acaa"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line"> authtypes.NewModuleAddress(govtypes.ModuleName).String(),</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token plain">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="logger">Logger<a href="#logger" class="hash-link" aria-label="Direct link to Logger" title="Direct link to Logger">​</a></h4><p>Replace all your CometBFT logger imports by <code>cosmossdk.io/log</code>.</p><p>Additionally, <code>depinject</code> / app di users must now supply a logger through the main <code>depinject.Supply</code> function instead of passing it to <code>appBuilder.Build</code>.</p><div class="language-diff codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-diff codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">appConfig = depinject.Configs(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">   AppConfig,</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">   depinject.Supply(</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">       // supply the application options</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">       appOpts,</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token inserted-sign inserted prefix inserted" style="color:#36acaa">+</span><span class="token inserted-sign inserted line" style="color:#36acaa">       logger,</span><br></span><span class="token-line" style="color:#393A34"><span class="token inserted-sign inserted line" style="color:#36acaa"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">   ...</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="language-diff codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-diff codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token deleted-sign deleted prefix deleted" style="color:#d73a49">-</span><span class="token deleted-sign deleted line" style="color:#d73a49"> app.App = appBuilder.Build(logger, db, traceStore, baseAppOptions...)</span><br></span><span class="token-line" style="color:#393A34"><span class="token deleted-sign deleted line" style="color:#d73a49"></span><span class="token inserted-sign inserted prefix inserted" style="color:#36acaa">+</span><span class="token inserted-sign inserted line" style="color:#36acaa"> app.App = appBuilder.Build(db, traceStore, baseAppOptions...)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>User manually wiring their chain need to add the logger argument when creating the <code>x/bank</code> keeper.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="module-basics">Module Basics<a href="#module-basics" class="hash-link" aria-label="Direct link to Module Basics" title="Direct link to Module Basics">​</a></h4><p>Previously, the <code>ModuleBasics</code> was a global variable that was used to register all modules&#x27; <code>AppModuleBasic</code> implementation.
The global variable has been removed and the basic module manager can be now created from the module manager.</p><p>This is automatically done for <code>depinject</code> / app di users, however for supplying different app module implementation, pass them via <code>depinject.Supply</code> in the main <code>AppConfig</code> (<code>app_config.go</code>):</p><div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">depinject</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Supply</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token comment" style="color:#999988;font-style:italic">// supply custom module basics</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">map</span><span class="token punctuation" style="color:#393A34">[</span><span class="token builtin">string</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">module</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">AppModuleBasic</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                genutiltypes</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">ModuleName</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> genutil</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">NewAppModuleBasic</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">genutiltypes</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">DefaultMessageValidator</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                govtypes</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">ModuleName</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> gov</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">NewAppModuleBasic</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">govclient</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">ProposalHandler</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        paramsclient</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">ProposalHandler</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Users manually wiring their chain need to use the new <code>module.NewBasicManagerFromManager</code> function, after the module manager creation, and pass a <code>map[string]module.AppModuleBasic</code> as argument for optionally overriding some module&#x27;s <code>AppModuleBasic</code>.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="autocli">AutoCLI<a href="#autocli" class="hash-link" aria-label="Direct link to AutoCLI" title="Direct link to AutoCLI">​</a></h4><p><a href="https://docs.cosmos.network/main/core/autocli" target="_blank" rel="noopener noreferrer"><code>AutoCLI</code></a> has been implemented by the SDK for all its module CLI queries. This means chains must add the following in their <code>root.go</code> to enable <code>AutoCLI</code> in their application:</p><div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> err </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> autoCliOpts</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">EnhanceRootCommand</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">rootCmd</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> err </span><span class="token operator" style="color:#393A34">!=</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">nil</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">panic</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">err</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Where <code>autoCliOpts</code> is the autocli options of the app, containing all modules and codecs.
That value can injected by depinject (<a href="https://github.com/cosmos/cosmos-sdk/blob/v0.50.0-beta.0/simapp/simd/cmd/root_v2.go#L49-L67" target="_blank" rel="noopener noreferrer">see root_v2.go</a>) or manually provided by the app (<a href="https://github.com/cosmos/cosmos-sdk/blob/v0.50.0-beta.0/simapp/app.go#L636-L655" target="_blank" rel="noopener noreferrer">see legacy app.go</a>).</p><div class="theme-admonition theme-admonition-warning alert alert--danger admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"></path></svg></span>danger</div><div class="admonitionContent_S0QG"><p>Not doing this will result in all core SDK modules queries not to be included in the binary.</p></div></div><p>Additionally <code>AutoCLI</code> automatically adds the custom modules commands to the root command for all modules implementing the <a href="https://pkg.go.dev/cosmossdk.io/core/appmodule#AppModule" target="_blank" rel="noopener noreferrer"><code>appmodule.AppModule</code></a> interface.
This means, after ensuring all the used modules implement this interface, the following can be removed from your <code>root.go</code>:</p><div class="language-diff codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-diff codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">func txCommand() *cobra.Command {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">   ....</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token deleted-sign deleted prefix deleted" style="color:#d73a49">-</span><span class="token deleted-sign deleted line" style="color:#d73a49"> appd.ModuleBasics.AddTxCommands(cmd)</span><br></span><span class="token-line" style="color:#393A34"><span class="token deleted-sign deleted line" style="color:#d73a49"></span><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="language-diff codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-diff codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">func queryCommand() *cobra.Command {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">   ....</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token deleted-sign deleted prefix deleted" style="color:#d73a49">-</span><span class="token deleted-sign deleted line" style="color:#d73a49"> appd.ModuleBasics.AddQueryCommands(cmd)</span><br></span><span class="token-line" style="color:#393A34"><span class="token deleted-sign deleted line" style="color:#d73a49"></span><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="packages">Packages<a href="#packages" class="hash-link" aria-label="Direct link to Packages" title="Direct link to Packages">​</a></h3><h4 class="anchor anchorWithStickyNavbar_LWe7" id="math">Math<a href="#math" class="hash-link" aria-label="Direct link to Math" title="Direct link to Math">​</a></h4><p>References to <code>types/math.go</code> which contained aliases for math types aliasing the <code>cosmossdk.io/math</code> package have been removed.
Import directly the <code>cosmossdk.io/math</code> package instead.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="store">Store<a href="#store" class="hash-link" aria-label="Direct link to Store" title="Direct link to Store">​</a></h4><p>References to <code>types/store.go</code> which contained aliases for store types have been remapped to point to appropriate <code>store/types</code>, hence the <code>types/store.go</code> file is no longer needed and has been removed.</p><h5 class="anchor anchorWithStickyNavbar_LWe7" id="extract-store-to-a-standalone-module">Extract Store to a standalone module<a href="#extract-store-to-a-standalone-module" class="hash-link" aria-label="Direct link to Extract Store to a standalone module" title="Direct link to Extract Store to a standalone module">​</a></h5><p>The <code>store</code> module is extracted to have a separate go.mod file which allows it be a standalone module.
All the store imports are now renamed to use <code>cosmossdk.io/store</code> instead of <code>github.com/cosmos/cosmos-sdk/store</code> across the SDK.</p><h5 class="anchor anchorWithStickyNavbar_LWe7" id="streaming">Streaming<a href="#streaming" class="hash-link" aria-label="Direct link to Streaming" title="Direct link to Streaming">​</a></h5><p><a href="https://docs.cosmos.network/main/architecture/adr-038-state-listening" target="_blank" rel="noopener noreferrer">ADR-38</a> has been implemented in the SDK.</p><p>To continue using state streaming, replace <code>streaming.LoadStreamingServices</code> by the following in your <code>app.go</code>:</p><div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> err </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> app</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">RegisterStreamingServices</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">appOpts</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> app</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">kvStoreKeys</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> err </span><span class="token operator" style="color:#393A34">!=</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">nil</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">panic</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">err</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="client">Client<a href="#client" class="hash-link" aria-label="Direct link to Client" title="Direct link to Client">​</a></h4><p>The return type of the interface method <code>TxConfig.SignModeHandler()</code> has been changed from <code>x/auth/signing.SignModeHandler</code> to <code>x/tx/signing.HandlerMap</code>. This change is transparent to most users as the <code>TxConfig</code> interface is typically implemented by private <code>x/auth/tx.config</code> struct (as returned by <code>auth.NewTxConfig</code>) which has been updated to return the new type. If users have implemented their own <code>TxConfig</code> interface, they will need to update their implementation to return the new type.</p><h5 class="anchor anchorWithStickyNavbar_LWe7" id="textual-sign-mode">Textual sign mode<a href="#textual-sign-mode" class="hash-link" aria-label="Direct link to Textual sign mode" title="Direct link to Textual sign mode">​</a></h5><p>A new sign mode is available in the SDK that produces more human readable output, currently only available on Ledger
devices but soon to be implemented in other UIs. </p><div class="theme-admonition theme-admonition-tip alert alert--success admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</div><div class="admonitionContent_S0QG"><p>This sign mode does not allow offline signing</p></div></div><p>When using (legacy) application wiring, the following must be added to <code>app.go</code> after setting the app&#x27;s bank keeper:</p><div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">    enabledSignModes </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">append</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">tx</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">DefaultSignModes</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> sigtypes</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">SignMode_SIGN_MODE_TEXTUAL</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    txConfigOpts </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> tx</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">ConfigOptions</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        EnabledSignModes</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">           enabledSignModes</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        TextualCoinMetadataQueryFn</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> txmodule</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">NewBankKeeperCoinMetadataQueryFn</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">app</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">BankKeeper</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    txConfig</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> err </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> tx</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">NewTxConfigWithOptions</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        appCodec</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        txConfigOpts</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> err </span><span class="token operator" style="color:#393A34">!=</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">nil</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        log</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Fatalf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Failed to create new TxConfig with options: %v&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> err</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    app</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">txConfig </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> txConfig</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>When using <code>depinject</code> / <code>app di</code>, <strong>it&#x27;s enabled by default</strong> if there&#x27;s a bank keeper present.</p><p>And in the application client (usually <code>root.go</code>):</p><div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">!</span><span class="token plain">clientCtx</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Offline </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        txConfigOpts</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">EnabledSignModes </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">append</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">txConfigOpts</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">EnabledSignModes</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> signing</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">SignMode_SIGN_MODE_TEXTUAL</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        txConfigOpts</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">TextualCoinMetadataQueryFn </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> txmodule</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">NewGRPCCoinMetadataQueryFn</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">clientCtx</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        txConfigWithTextual</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> err </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> tx</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">NewTxConfigWithOptions</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            codec</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">NewProtoCodec</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">clientCtx</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">InterfaceRegistry</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            txConfigOpts</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> err </span><span class="token operator" style="color:#393A34">!=</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">nil</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> err</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        clientCtx </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> clientCtx</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">WithTxConfig</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">txConfigWithTextual</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>When using <code>depinject</code> / <code>app di</code>, the tx config should be recreated from the <code>txConfigOpts</code> to use <code>NewGRPCCoinMetadataQueryFn</code> instead of depending on the bank keeper (that is used in the server).</p><p>To learn more see the <a href="https://docs.cosmos.network/main/learn/advanced/transactions#sign_mode_textual" target="_blank" rel="noopener noreferrer">docs</a> and the <a href="https://docs.cosmos.network/main/build/architecture/adr-050-sign-mode-textual" target="_blank" rel="noopener noreferrer">ADR-050</a>.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="modules-1">Modules<a href="#modules-1" class="hash-link" aria-label="Direct link to Modules" title="Direct link to Modules">​</a></h3><h4 class="anchor anchorWithStickyNavbar_LWe7" id="all-1"><code>**all**</code><a href="#all-1" class="hash-link" aria-label="Direct link to all-1" title="Direct link to all-1">​</a></h4><ul><li><p><a href="https://docs.cosmos.network/main/rfc/rfc-001-tx-validation" target="_blank" rel="noopener noreferrer">RFC 001</a> has defined a simplification of the message validation process for modules.
The <code>sdk.Msg</code> interface has been updated to not require the implementation of the <code>ValidateBasic</code> method.
It is now recommended to validate message directly in the message server. When the validation is performed in the message server, the <code>ValidateBasic</code> method on a message is no longer required and can be removed.</p></li><li><p>Messages no longer need to implement the <code>LegacyMsg</code> interface and implementations of <code>GetSignBytes</code> can be deleted. Because of this change, global legacy Amino codec definitions and their registration in <code>init()</code> can safely be removed as well.</p></li><li><p>The <code>AppModuleBasic</code> interface has been simplified. Defining <code>GetTxCmd() *cobra.Command</code> and <code>GetQueryCmd() *cobra.Command</code> is no longer required. The module manager detects when module commands are defined. If AutoCLI is enabled, <code>EnhanceRootCommand()</code> will add the auto-generated commands to the root command, unless a custom module command is defined and register that one instead.</p></li><li><p>The following modules&#x27; <code>Keeper</code> methods now take in a <code>context.Context</code> instead of <code>sdk.Context</code>. Any module that has an interfaces for them (like &quot;expected keepers&quot;) will need to update and re-generate mocks if needed:</p><ul><li><code>x/authz</code></li><li><code>x/bank</code></li><li><code>x/mint</code></li><li><code>x/crisis</code></li><li><code>x/distribution</code></li><li><code>x/evidence</code></li><li><code>x/gov</code></li><li><code>x/slashing</code></li><li><code>x/upgrade</code></li></ul></li><li><p><code>BeginBlock</code> and <code>EndBlock</code> have changed their signature, so it is important that any module implementing them are updated accordingly.</p></li></ul><div class="language-diff codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-diff codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token deleted-sign deleted prefix deleted" style="color:#d73a49">-</span><span class="token deleted-sign deleted line" style="color:#d73a49"> BeginBlock(sdk.Context, abci.RequestBeginBlock)</span><br></span><span class="token-line" style="color:#393A34"><span class="token deleted-sign deleted line" style="color:#d73a49"></span><span class="token inserted-sign inserted prefix inserted" style="color:#36acaa">+</span><span class="token inserted-sign inserted line" style="color:#36acaa"> BeginBlock(context.Context) error</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="language-diff codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-diff codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token deleted-sign deleted prefix deleted" style="color:#d73a49">-</span><span class="token deleted-sign deleted line" style="color:#d73a49"> EndBlock(sdk.Context, abci.RequestEndBlock) []abci.ValidatorUpdate</span><br></span><span class="token-line" style="color:#393A34"><span class="token deleted-sign deleted line" style="color:#d73a49"></span><span class="token inserted-sign inserted prefix inserted" style="color:#36acaa">+</span><span class="token inserted-sign inserted line" style="color:#36acaa"> EndBlock(context.Context) error</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>In case a module requires to return <code>abci.ValidatorUpdate</code> from <code>EndBlock</code>, it can use the <code>HasABCIEndBlock</code> interface instead.</p><div class="language-diff codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-diff codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token deleted-sign deleted prefix deleted" style="color:#d73a49">-</span><span class="token deleted-sign deleted line" style="color:#d73a49"> EndBlock(sdk.Context, abci.RequestEndBlock) []abci.ValidatorUpdate</span><br></span><span class="token-line" style="color:#393A34"><span class="token deleted-sign deleted line" style="color:#d73a49"></span><span class="token inserted-sign inserted prefix inserted" style="color:#36acaa">+</span><span class="token inserted-sign inserted line" style="color:#36acaa"> EndBlock(context.Context) ([]abci.ValidatorUpdate, error)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="theme-admonition theme-admonition-tip alert alert--success admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</div><div class="admonitionContent_S0QG"><p>It is possible to ensure that a module implements the correct interfaces by using compiler assertions in your <code>x/{moduleName}/module.go</code>:</p><div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token boolean" style="color:#36acaa">_</span><span class="token plain"> module</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">AppModuleBasic      </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">*</span><span class="token plain">AppModule</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">(</span><span class="token boolean" style="color:#36acaa">nil</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token boolean" style="color:#36acaa">_</span><span class="token plain"> module</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">AppModuleSimulation </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">*</span><span class="token plain">AppModule</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">(</span><span class="token boolean" style="color:#36acaa">nil</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token boolean" style="color:#36acaa">_</span><span class="token plain"> module</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">HasGenesis          </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">*</span><span class="token plain">AppModule</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">(</span><span class="token boolean" style="color:#36acaa">nil</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token boolean" style="color:#36acaa">_</span><span class="token plain"> appmodule</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">AppModule        </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">*</span><span class="token plain">AppModule</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">(</span><span class="token boolean" style="color:#36acaa">nil</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token boolean" style="color:#36acaa">_</span><span class="token plain"> appmodule</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">HasBeginBlocker  </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">*</span><span class="token plain">AppModule</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">(</span><span class="token boolean" style="color:#36acaa">nil</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token boolean" style="color:#36acaa">_</span><span class="token plain"> appmodule</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">HasEndBlocker    </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">*</span><span class="token plain">AppModule</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">(</span><span class="token boolean" style="color:#36acaa">nil</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token operator" style="color:#393A34">...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Read more on those interfaces <a href="https://docs.cosmos.network/v0.50/building-modules/module-manager#application-module-interfaces" target="_blank" rel="noopener noreferrer">here</a>.</p></div></div><ul><li><code>GetSigners()</code> is no longer required to be implemented on <code>Msg</code> types. The SDK will automatically infer the signers from the <code>Signer</code> field on the message. The signer field is required on all messages unless using a custom signer function.</li></ul><p>To find out more please read the <a href="https://github.com/cosmos/cosmos-sdk/blob/main/docs/build/building-modules/05-protobuf-annotations.md" target="_blank" rel="noopener noreferrer">signer field</a> &amp; <a href="https://github.com/cosmos/cosmos-sdk/blob/7352d0bce8e72121e824297df453eb1059c28da8/docs/docs/build/building-modules/02-messages-and-queries.md#L40" target="_blank" rel="noopener noreferrer">here</a> documentation.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="xauth-1"><code>x/auth</code><a href="#xauth-1" class="hash-link" aria-label="Direct link to xauth-1" title="Direct link to xauth-1">​</a></h4><p>For ante handler construction via <code>ante.NewAnteHandler</code>, the field <code>ante.HandlerOptions.SignModeHandler</code> has been updated to <code>x/tx/signing/HandlerMap</code> from <code>x/auth/signing/SignModeHandler</code>. Callers typically fetch this value from <code>client.TxConfig.SignModeHandler()</code> (which is also changed) so this change should be transparent to most users.</p><h5 class="anchor anchorWithStickyNavbar_LWe7" id="account-migration-guide-xauth-to-xaccounts">Account Migration Guide: x/auth to x/accounts<a href="#account-migration-guide-xauth-to-xaccounts" class="hash-link" aria-label="Direct link to Account Migration Guide: x/auth to x/accounts" title="Direct link to Account Migration Guide: x/auth to x/accounts">​</a></h5><p>Users can now migrate accounts from <code>x/auth</code> to <code>x/accounts</code> using the <code>auth.MsgMigrateAccount</code> message. Currently, this migration is only supported for <code>BaseAccount</code> due to security considerations.</p><h6 class="anchor anchorWithStickyNavbar_LWe7" id="migration-process">Migration Process<a href="#migration-process" class="hash-link" aria-label="Direct link to Migration Process" title="Direct link to Migration Process">​</a></h6><p>The migration process allows an auth BaseAccount to migrate to any kind of x/accounts supported account type, here we will show how to migrate from a legacy x/auth <code>BaseAccount</code> to a <code>x/accounts</code> <code>BaseAccount</code></p><p>####### Migrating to x/accounts/defaults/base</p><p>To migrate to the <code>BaseAccount</code> in <code>x/accounts</code>, follow these steps:</p><ol><li>Send a <code>basev1.MsgInit</code> message.</li><li>This process allows you to:<ul><li>Switch to a new public key</li><li>Reset your sequence number</li></ul></li></ol><blockquote><p><strong>Important</strong>: If you intend to keep the same public key, ensure you use your current sequence number.</p></blockquote><h6 class="anchor anchorWithStickyNavbar_LWe7" id="example-xauthmsgmigrateaccount">Example: x/auth.MsgMigrateAccount<a href="#example-xauthmsgmigrateaccount" class="hash-link" aria-label="Direct link to Example: x/auth.MsgMigrateAccount" title="Direct link to Example: x/auth.MsgMigrateAccount">​</a></h6><p>Here&#x27;s an example of the <code>x/auth.MsgMigrateAccount</code> message structure:</p><div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;signer&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;cosmos1w43tr39v3lzvxz969e4ty9a74rq9nw7563tqvy&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;account_type&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;base&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;account_init_msg&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;@type&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;/cosmos.accounts.defaults.base.v1.MsgInit&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;pub_key&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;@type&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;/cosmos.crypto.secp256k1.PubKey&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;key&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;AkeoE1z32tlQyE7xpx3v+JE9XJL0trVQBFoDCn0pGl3w&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;init_sequence&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;100&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Field Descriptions</strong></p><ul><li><code>signer</code>: The address of the account you want to migrate from.</li><li><code>account_type</code>: The new account type you want to migrate to (depends on what&#x27;s installed on the chain).</li><li><code>account_init_msg</code>: The custom initialization message for the new account.<ul><li><code>@type</code>: Specifies the type of account (in this case, x/accounts base account).</li><li><code>pub_key</code>: The public key for the account. You can migrate to a different public key if desired.</li><li><code>init_sequence</code>: The new sequence number for the account.</li></ul></li></ul><blockquote><p><strong>Warning</strong>: If you&#x27;re keeping the same public key, make sure to use your current sequence number to prevent potential replay attacks.</p></blockquote><h4 class="anchor anchorWithStickyNavbar_LWe7" id="xcapability"><code>x/capability</code><a href="#xcapability" class="hash-link" aria-label="Direct link to xcapability" title="Direct link to xcapability">​</a></h4><p>Capability has been moved to <a href="https://github.com/cosmos/ibc-go" target="_blank" rel="noopener noreferrer">IBC Go</a>. IBC v8 will contain the necessary changes to incorporate the new module location.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="xgenutil"><code>x/genutil</code><a href="#xgenutil" class="hash-link" aria-label="Direct link to xgenutil" title="Direct link to xgenutil">​</a></h4><p>The Cosmos SDK has migrated from a CometBFT genesis to a application managed genesis file.
The genesis is now fully handled by <code>x/genutil</code>. This has no consequences for running chains:</p><ul><li>Importing a CometBFT genesis is still supported.</li><li>Exporting a genesis now exports the genesis as an application genesis.</li></ul><p>When needing to read an application genesis, use the following helpers from the <code>x/genutil/types</code> package:</p><div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// AppGenesisFromReader reads the AppGenesis from the reader.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">func</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">AppGenesisFromReader</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">reader io</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Reader</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">*</span><span class="token plain">AppGenesis</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token builtin">error</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// AppGenesisFromFile reads the AppGenesis from the provided file.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">func</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">AppGenesisFromFile</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">genFile </span><span class="token builtin">string</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">*</span><span class="token plain">AppGenesis</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token builtin">error</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="xgov-1"><code>x/gov</code><a href="#xgov-1" class="hash-link" aria-label="Direct link to xgov-1" title="Direct link to xgov-1">​</a></h4><h5 class="anchor anchorWithStickyNavbar_LWe7" id="expedited-proposals">Expedited Proposals<a href="#expedited-proposals" class="hash-link" aria-label="Direct link to Expedited Proposals" title="Direct link to Expedited Proposals">​</a></h5><p>The <code>gov</code> v1 module now supports expedited governance proposals. When a proposal is expedited, the voting period will be shortened to <code>ExpeditedVotingPeriod</code> parameter. An expedited proposal must have an higher voting threshold than a classic proposal, that threshold is defined with the <code>ExpeditedThreshold</code> parameter.</p><h5 class="anchor anchorWithStickyNavbar_LWe7" id="cancelling-proposals">Cancelling Proposals<a href="#cancelling-proposals" class="hash-link" aria-label="Direct link to Cancelling Proposals" title="Direct link to Cancelling Proposals">​</a></h5><p>The <code>gov</code> module now supports cancelling governance proposals. When a proposal is canceled, all the deposits of the proposal are either burnt or sent to <code>ProposalCancelDest</code> address. The deposits burn rate will be determined by a new parameter called <code>ProposalCancelRatio</code> parameter.</p><div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">1. deposits * proposal_cancel_ratio will be burned or sent to `ProposalCancelDest` address , if `ProposalCancelDest` is empty then deposits will be burned.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2. deposits * (1 - proposal_cancel_ratio) will be sent to depositors.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>By default, the new <code>ProposalCancelRatio</code> parameter is set to <code>0.5</code> during migration and <code>ProposalCancelDest</code> is set to empty string (i.e. burnt).</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="xevidence"><code>x/evidence</code><a href="#xevidence" class="hash-link" aria-label="Direct link to xevidence" title="Direct link to xevidence">​</a></h4><h5 class="anchor anchorWithStickyNavbar_LWe7" id="extract-evidence-to-a-standalone-module">Extract evidence to a standalone module<a href="#extract-evidence-to-a-standalone-module" class="hash-link" aria-label="Direct link to Extract evidence to a standalone module" title="Direct link to Extract evidence to a standalone module">​</a></h5><p>The <code>x/evidence</code> module is extracted to have a separate go.mod file which allows it be a standalone module.
All the evidence imports are now renamed to use <code>cosmossdk.io/x/evidence</code> instead of <code>github.com/cosmos/cosmos-sdk/x/evidence</code> across the SDK.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="xnft"><code>x/nft</code><a href="#xnft" class="hash-link" aria-label="Direct link to xnft" title="Direct link to xnft">​</a></h4><h5 class="anchor anchorWithStickyNavbar_LWe7" id="extract-nft-to-a-standalone-module">Extract nft to a standalone module<a href="#extract-nft-to-a-standalone-module" class="hash-link" aria-label="Direct link to Extract nft to a standalone module" title="Direct link to Extract nft to a standalone module">​</a></h5><p>The <code>x/nft</code> module is extracted to have a separate go.mod file which allows it to be a standalone module.
All the evidence imports are now renamed to use <code>cosmossdk.io/x/nft</code> instead of <code>github.com/cosmos/cosmos-sdk/x/nft</code> across the SDK.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="xfeegrant">x/feegrant<a href="#xfeegrant" class="hash-link" aria-label="Direct link to x/feegrant" title="Direct link to x/feegrant">​</a></h4><h5 class="anchor anchorWithStickyNavbar_LWe7" id="extract-feegrant-to-a-standalone-module">Extract feegrant to a standalone module<a href="#extract-feegrant-to-a-standalone-module" class="hash-link" aria-label="Direct link to Extract feegrant to a standalone module" title="Direct link to Extract feegrant to a standalone module">​</a></h5><p>The <code>x/feegrant</code> module is extracted to have a separate go.mod file which allows it to be a standalone module.
All the feegrant imports are now renamed to use <code>cosmossdk.io/x/feegrant</code> instead of <code>github.com/cosmos/cosmos-sdk/x/feegrant</code> across the SDK.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="xupgrade"><code>x/upgrade</code><a href="#xupgrade" class="hash-link" aria-label="Direct link to xupgrade" title="Direct link to xupgrade">​</a></h4><h5 class="anchor anchorWithStickyNavbar_LWe7" id="extract-upgrade-to-a-standalone-module">Extract upgrade to a standalone module<a href="#extract-upgrade-to-a-standalone-module" class="hash-link" aria-label="Direct link to Extract upgrade to a standalone module" title="Direct link to Extract upgrade to a standalone module">​</a></h5><p>The <code>x/upgrade</code> module is extracted to have a separate go.mod file which allows it to be a standalone module.
All the upgrade imports are now renamed to use <code>cosmossdk.io/x/upgrade</code> instead of <code>github.com/cosmos/cosmos-sdk/x/upgrade</code> across the SDK.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="tooling">Tooling<a href="#tooling" class="hash-link" aria-label="Direct link to Tooling" title="Direct link to Tooling">​</a></h3><h4 class="anchor anchorWithStickyNavbar_LWe7" id="rosetta">Rosetta<a href="#rosetta" class="hash-link" aria-label="Direct link to Rosetta" title="Direct link to Rosetta">​</a></h4><p>Rosetta has moved to it&#x27;s own <a href="https://github.com/cosmos/rosetta" target="_blank" rel="noopener noreferrer">repo</a> and not imported by the Cosmos SDK SimApp by default.
Any user who is interested on using the tool can connect it standalone to any node without the need to add it as part of the node binary.
The rosetta tool also allows multi chain connections.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="v047x"><a href="https://github.com/cosmos/cosmos-sdk/releases/tag/v0.47.0" target="_blank" rel="noopener noreferrer">v0.47.x</a><a href="#v047x" class="hash-link" aria-label="Direct link to v047x" title="Direct link to v047x">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="migration-to-cometbft-part-1">Migration to CometBFT (Part 1)<a href="#migration-to-cometbft-part-1" class="hash-link" aria-label="Direct link to Migration to CometBFT (Part 1)" title="Direct link to Migration to CometBFT (Part 1)">​</a></h3><p>The Cosmos SDK has migrated to CometBFT, as its default consensus engine.
CometBFT is an implementation of the Tendermint consensus algorithm, and the successor of Tendermint Core.
Due to the import changes, this is a breaking change. Chains need to remove <strong>entirely</strong> their imports of Tendermint Core in their codebase, from direct and indirects imports in their <code>go.mod</code>.</p><ul><li>Replace <code>github.com/tendermint/tendermint</code> by <code>github.com/cometbft/cometbft</code></li><li>Replace <code>github.com/tendermint/tm-db</code> by <code>github.com/cometbft/cometbft-db</code></li><li>Verify <code>github.com/tendermint/tendermint</code> is not an indirect or direct dependency</li><li>Run <code>make proto-gen</code></li></ul><p>Other than that, the migration should be seamless.
On the SDK side, clean-up of variables, functions to reflect the new name will only happen from v0.50 (part 2).</p><p>Note: It is possible that these steps must first be performed by your dependencies before you can perform them on your own codebase.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="simulation-1">Simulation<a href="#simulation-1" class="hash-link" aria-label="Direct link to Simulation" title="Direct link to Simulation">​</a></h3><p>Remove <code>RandomizedParams</code> from <code>AppModuleSimulation</code> interface. Previously, it used to generate random parameter changes during simulations, however, it does so through ParamChangeProposal which is now legacy. Since all modules were migrated, we can now safely remove this from <code>AppModuleSimulation</code> interface.</p><p>Moreover, to support the <code>MsgUpdateParams</code> governance proposals for each modules, <code>AppModuleSimulation</code> now defines a <code>AppModule.ProposalMsgs</code> method in addition to <code>AppModule.ProposalContents</code>. That method defines the messages that can be used to submit a proposal and that should be tested in simulation.</p><p>When a module has no proposal messages or proposal content to be tested by simulation, the <code>AppModule.ProposalMsgs</code> and <code>AppModule.ProposalContents</code> methods can be deleted.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="grpc">gRPC<a href="#grpc" class="hash-link" aria-label="Direct link to gRPC" title="Direct link to gRPC">​</a></h3><p>A new gRPC service, <code>proto/cosmos/base/node/v1beta1/query.proto</code>, has been introduced
which exposes various operator configuration. App developers should be sure to
register the service with the gRPC-gateway service via
<code>nodeservice.RegisterGRPCGatewayRoutes</code> in their application construction, which
is typically found in <code>RegisterAPIRoutes</code>.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="appmodule-interface">AppModule Interface<a href="#appmodule-interface" class="hash-link" aria-label="Direct link to AppModule Interface" title="Direct link to AppModule Interface">​</a></h3><p>Support for the <code>AppModule</code> <code>Querier</code>, <code>Route</code> and <code>LegacyQuerier</code> methods has been entirely removed from the <code>AppModule</code>
interface. This removes and fully deprecates all legacy queriers. All modules no longer support the REST API previously
known as the LCD, and the <code>sdk.Msg#Route</code> method won&#x27;t be used anymore.</p><p>Most other existing <code>AppModule</code> methods have been moved to extension interfaces in preparation for the migration
to the <code>cosmossdk.io/core/appmodule</code> API in the next release. Most <code>AppModule</code> implementations should not be broken
by this change.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="simapp-2">SimApp<a href="#simapp-2" class="hash-link" aria-label="Direct link to SimApp" title="Direct link to SimApp">​</a></h3><p>The <code>simapp</code> package <strong>should not be imported in your own app</strong>. Instead, you should import the <code>runtime.AppI</code> interface, that defines an <code>App</code>, and use the <a href="https://pkg.go.dev/github.com/cosmos/cosmos-sdk/testutil/sims" target="_blank" rel="noopener noreferrer"><code>simtestutil</code> package</a> for application testing.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="app-wiring">App Wiring<a href="#app-wiring" class="hash-link" aria-label="Direct link to App Wiring" title="Direct link to App Wiring">​</a></h4><p>SimApp&#x27;s <code>app_di.go</code> is using <a href="https://docs.cosmos.network/main/build/building-apps/app-go-di" target="_blank" rel="noopener noreferrer">App Wiring</a>, the dependency injection framework of the Cosmos SDK.
This means that modules are injected directly into SimApp thanks to a <a href="https://github.com/cosmos/cosmos-sdk/blob/v0.47.0-rc1/simapp/app_config.go" target="_blank" rel="noopener noreferrer">configuration file</a>.
The previous behavior, without the dependency injection framework, is still present in <a href="https://github.com/cosmos/cosmos-sdk/blob/v0.47.0-rc1/simapp/app.go" target="_blank" rel="noopener noreferrer"><code>app.go</code></a> and is not going anywhere.</p><p>If you are using a <code>app.go</code> without dependency injection, add the following lines to your <code>app.go</code> in order to provide newer gRPC services:</p><div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">autocliv1</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">RegisterQueryServer</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">app</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">GRPCQueryRouter</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> runtimeservices</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">NewAutoCLIQueryService</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">app</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">ModuleManager</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Modules</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">reflectionSvc</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> err </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> runtimeservices</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">NewReflectionService</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> err </span><span class="token operator" style="color:#393A34">!=</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">nil</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">panic</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">err</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">reflectionv1</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">RegisterReflectionServiceServer</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">app</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">GRPCQueryRouter</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> reflectionSvc</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="constructor">Constructor<a href="#constructor" class="hash-link" aria-label="Direct link to Constructor" title="Direct link to Constructor">​</a></h4><p>The constructor, <code>NewSimApp</code> has been simplified:</p><ul><li><code>NewSimApp</code> does not take encoding parameters (<code>encodingConfig</code>) as input, instead the encoding parameters are injected (when using app wiring), or directly created in the constructor. Instead, we can instantiate <code>SimApp</code> for getting the encoding configuration.</li><li><code>NewSimApp</code> now uses <code>AppOptions</code> for getting the home path (<code>homePath</code>) and the invariant checks period (<code>invCheckPeriod</code>). These were unnecessary given as arguments as they were already present in the <code>AppOptions</code>.</li></ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="encoding">Encoding<a href="#encoding" class="hash-link" aria-label="Direct link to Encoding" title="Direct link to Encoding">​</a></h4><p><code>simapp.MakeTestEncodingConfig()</code> was deprecated and has been removed. Instead you can use the <code>TestEncodingConfig</code> from the <code>types/module/testutil</code> package.
This means you can replace your usage of <code>simapp.MakeTestEncodingConfig</code> in tests to <code>moduletestutil.MakeTestEncodingConfig</code>, which takes a series of relevant <code>AppModuleBasic</code> as input (the module being tested and any potential dependencies).</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="export">Export<a href="#export" class="hash-link" aria-label="Direct link to Export" title="Direct link to Export">​</a></h4><p><code>ExportAppStateAndValidators</code> takes an extra argument, <code>modulesToExport</code>, which is a list of module names to export.
That argument should be passed to the module maanager <code>ExportGenesisFromModules</code> method.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="replaces">Replaces<a href="#replaces" class="hash-link" aria-label="Direct link to Replaces" title="Direct link to Replaces">​</a></h4><p>The <code>GoLevelDB</code> version must pinned to <code>v1.0.1-0.20210819022825-2ae1ddf74ef7</code> in the application, following versions might cause unexpected behavior.
This can be done adding <code>replace github.com/syndtr/goleveldb =&gt; github.com/syndtr/goleveldb v1.0.1-0.20210819022825-2ae1ddf74ef7</code> to the <code>go.mod</code> file.</p><ul><li><a href="https://github.com/cosmos/cosmos-sdk/issues/14949" target="_blank" rel="noopener noreferrer">issue #14949 on cosmos-sdk</a></li><li><a href="https://github.com/ethereum/go-ethereum/pull/25413" target="_blank" rel="noopener noreferrer">issue #25413 on go-ethereum</a></li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="protobuf-2">Protobuf<a href="#protobuf-2" class="hash-link" aria-label="Direct link to Protobuf" title="Direct link to Protobuf">​</a></h3><p>The SDK has migrated from <code>gogo/protobuf</code> (which is currently unmaintained), to our own maintained fork, <a href="https://github.com/cosmos/gogoproto" target="_blank" rel="noopener noreferrer"><code>cosmos/gogoproto</code></a>.</p><p>This means you should replace all imports of <code>github.com/gogo/protobuf</code> to <code>github.com/cosmos/gogoproto</code>.
This allows you to remove the replace directive <code>replace github.com/gogo/protobuf =&gt; github.com/regen-network/protobuf v1.3.3-alpha.regen.1</code> from your <code>go.mod</code> file.</p><p>Please use the <code>ghcr.io/cosmos/proto-builder</code> image (version &gt;= <code>0.11.5</code>) for generating protobuf files.</p><p>See which buf commit for <code>cosmos/cosmos-sdk</code> to pin in your <code>buf.yaml</code> file <a href="https://github.com/cosmos/cosmos-sdk/blob/main/proto/README.md" target="_blank" rel="noopener noreferrer">here</a>.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="gogoproto-import-paths">Gogoproto Import Paths<a href="#gogoproto-import-paths" class="hash-link" aria-label="Direct link to Gogoproto Import Paths" title="Direct link to Gogoproto Import Paths">​</a></h4><p>The SDK made a <a href="https://github.com/cosmos/gogoproto/pull/32" target="_blank" rel="noopener noreferrer">patch fix</a> on its gogoproto repository to require that each proto file&#x27;s package name matches its OS import path (relatively to a protobuf root import path, usually the root <code>proto/</code> folder, set by the <code>protoc -I</code> flag).</p><p>For example, assuming you put all your proto files in subfolders inside your root <code>proto/</code> folder, then a proto file with package name <code>myapp.mymodule.v1</code> should be found in the <code>proto/myapp/mymodule/v1/</code> folder. If it is in another folder, the proto generation command will throw an error.</p><p>If you are using a custom folder structure for your proto files, please reorganize them so that their OS path matches their proto package name.</p><p>This is to allow the proto FileDescriptSets to be correctly registered, and this standardized OS import paths allows <a href="https://github.com/cosmos/cosmos-sdk/tree/main/tools/hubl" target="_blank" rel="noopener noreferrer">Hubl</a> to reflectively talk to any chain.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="acceptsimplements_interface-proto-annotations"><code>{accepts,implements}_interface</code> proto annotations<a href="#acceptsimplements_interface-proto-annotations" class="hash-link" aria-label="Direct link to acceptsimplements_interface-proto-annotations" title="Direct link to acceptsimplements_interface-proto-annotations">​</a></h4><p>The SDK is normalizing the strings inside the Protobuf <code>accepts_interface</code> and <code>implements_interface</code> annotations. We require them to be fully-scoped names. They will soon be used by code generators like Pulsar and Telescope to match which messages can or cannot be packed inside <code>Any</code>s.</p><p>Here are the following replacements that you need to perform on your proto files:</p><div class="language-diff codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-diff codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token deleted-sign deleted prefix deleted" style="color:#d73a49">-</span><span class="token deleted-sign deleted line" style="color:#d73a49"> &quot;Content&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token deleted-sign deleted line" style="color:#d73a49"></span><span class="token inserted-sign inserted prefix inserted" style="color:#36acaa">+</span><span class="token inserted-sign inserted line" style="color:#36acaa"> &quot;cosmos.gov.v1beta1.Content&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token inserted-sign inserted line" style="color:#36acaa"></span><span class="token deleted-sign deleted prefix deleted" style="color:#d73a49">-</span><span class="token deleted-sign deleted line" style="color:#d73a49"> &quot;Authorization&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token deleted-sign deleted line" style="color:#d73a49"></span><span class="token inserted-sign inserted prefix inserted" style="color:#36acaa">+</span><span class="token inserted-sign inserted line" style="color:#36acaa"> &quot;cosmos.authz.v1beta1.Authorization&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token inserted-sign inserted line" style="color:#36acaa"></span><span class="token deleted-sign deleted prefix deleted" style="color:#d73a49">-</span><span class="token deleted-sign deleted line" style="color:#d73a49"> &quot;sdk.Msg&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token deleted-sign deleted line" style="color:#d73a49"></span><span class="token inserted-sign inserted prefix inserted" style="color:#36acaa">+</span><span class="token inserted-sign inserted line" style="color:#36acaa"> &quot;cosmos.base.v1beta1.Msg&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token inserted-sign inserted line" style="color:#36acaa"></span><span class="token deleted-sign deleted prefix deleted" style="color:#d73a49">-</span><span class="token deleted-sign deleted line" style="color:#d73a49"> &quot;AccountI&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token deleted-sign deleted line" style="color:#d73a49"></span><span class="token inserted-sign inserted prefix inserted" style="color:#36acaa">+</span><span class="token inserted-sign inserted line" style="color:#36acaa"> &quot;cosmos.auth.v1beta1.AccountI&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token inserted-sign inserted line" style="color:#36acaa"></span><span class="token deleted-sign deleted prefix deleted" style="color:#d73a49">-</span><span class="token deleted-sign deleted line" style="color:#d73a49"> &quot;ModuleAccountI&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token deleted-sign deleted line" style="color:#d73a49"></span><span class="token inserted-sign inserted prefix inserted" style="color:#36acaa">+</span><span class="token inserted-sign inserted line" style="color:#36acaa"> &quot;cosmos.auth.v1beta1.ModuleAccountI&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token inserted-sign inserted line" style="color:#36acaa"></span><span class="token deleted-sign deleted prefix deleted" style="color:#d73a49">-</span><span class="token deleted-sign deleted line" style="color:#d73a49"> &quot;FeeAllowanceI&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token deleted-sign deleted line" style="color:#d73a49"></span><span class="token inserted-sign inserted prefix inserted" style="color:#36acaa">+</span><span class="token inserted-sign inserted line" style="color:#36acaa"> &quot;cosmos.feegrant.v1beta1.FeeAllowanceI&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Please also check that in your own app&#x27;s proto files that there are no single-word names for those two proto annotations. If so, then replace them with fully-qualified names, even though those names don&#x27;t actually resolve to an actual protobuf entity.</p><p>For more information, see the <a href="https://github.com/cosmos/cosmos-sdk/blob/main/docs/learn/advanced/05-encoding.md" target="_blank" rel="noopener noreferrer">encoding guide</a>.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="transactions">Transactions<a href="#transactions" class="hash-link" aria-label="Direct link to Transactions" title="Direct link to Transactions">​</a></h3><h4 class="anchor anchorWithStickyNavbar_LWe7" id="broadcast-mode">Broadcast Mode<a href="#broadcast-mode" class="hash-link" aria-label="Direct link to Broadcast Mode" title="Direct link to Broadcast Mode">​</a></h4><p>Broadcast mode <code>block</code> was deprecated and has been removed. Please use <code>sync</code> mode
instead. When upgrading your tests from <code>block</code> to <code>sync</code> and checking for a
transaction code, you need to query the transaction first (with its hash) to get
the correct code.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="modules-2">Modules<a href="#modules-2" class="hash-link" aria-label="Direct link to Modules" title="Direct link to Modules">​</a></h3><h4 class="anchor anchorWithStickyNavbar_LWe7" id="all-2"><code>**all**</code><a href="#all-2" class="hash-link" aria-label="Direct link to all-2" title="Direct link to all-2">​</a></h4><p><code>EventTypeMessage</code> events, with <code>sdk.AttributeKeyModule</code> and <code>sdk.AttributeKeySender</code> are now emitted directly at message execution (in <code>baseapp</code>).
This means that the following boilerplate should be removed from all your custom modules:</p><div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ctx</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">EventManager</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">EmitEvent</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    sdk</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">NewEvent</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        sdk</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">EventTypeMessage</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        sdk</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">NewAttribute</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">sdk</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">AttributeKeyModule</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> types</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">AttributeValueCategory</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        sdk</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">NewAttribute</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">sdk</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">AttributeKeySender</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">`signer/sender`</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The module name is assumed by <code>baseapp</code> to be the second element of the message route: <code>&quot;cosmos.bank.v1beta1.MsgSend&quot; -&gt; &quot;bank&quot;</code>.
In case a module does not follow the standard message path, (e.g. IBC), it is advised to keep emitting the module name event.
<code>Baseapp</code> only emits that event if the module has not already done so.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="xparams"><code>x/params</code><a href="#xparams" class="hash-link" aria-label="Direct link to xparams" title="Direct link to xparams">​</a></h4><p>The <code>params</code> module was deprecated since v0.46. The Cosmos SDK has migrated away from <code>x/params</code> for its own modules.
Cosmos SDK modules now store their parameters directly in its respective modules.
The <code>params</code> module will be removed in <code>v0.50</code>, as mentioned <a href="https://github.com/cosmos/cosmos-sdk/blob/v0.46.1/UPGRADING.md#xparams" target="_blank" rel="noopener noreferrer">in v0.46 release</a>. It is strongly encouraged to migrate away from <code>x/params</code> before <code>v0.50</code>.</p><p>When performing a chain migration, the params table must be initizalied manually. This was done in the modules keepers in previous versions.
Have a look at <code>simapp.RegisterUpgradeHandlers()</code> for an example.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="xcrisis-1"><code>x/crisis</code><a href="#xcrisis-1" class="hash-link" aria-label="Direct link to xcrisis-1" title="Direct link to xcrisis-1">​</a></h4><p>With the migrations of all modules away from <code>x/params</code>, the crisis module now has a store.
The store must be created during a chain upgrade to v0.47.x.</p><div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">storetypes</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">StoreUpgrades</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Added</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token builtin">string</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                crisistypes</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">ModuleName</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="xgov-2"><code>x/gov</code><a href="#xgov-2" class="hash-link" aria-label="Direct link to xgov-2" title="Direct link to xgov-2">​</a></h4><h5 class="anchor anchorWithStickyNavbar_LWe7" id="minimum-proposal-deposit-at-time-of-submission">Minimum Proposal Deposit At Time of Submission<a href="#minimum-proposal-deposit-at-time-of-submission" class="hash-link" aria-label="Direct link to Minimum Proposal Deposit At Time of Submission" title="Direct link to Minimum Proposal Deposit At Time of Submission">​</a></h5><p>The <code>gov</code> module has been updated to support a minimum proposal deposit at submission time. It is determined by a new
parameter called <code>MinInitialDepositRatio</code>. When multiplied by the existing <code>MinDeposit</code> parameter, it produces
the necessary proportion of coins needed at the proposal submission time. The motivation for this change is to prevent proposal spamming.</p><p>By default, the new <code>MinInitialDepositRatio</code> parameter is set to zero during migration. The value of zero signifies that this
feature is disabled. If chains wish to utilize the minimum proposal deposits at time of submission, the migration logic needs to be
modified to set the new parameter to the desired value.</p><h5 class="anchor anchorWithStickyNavbar_LWe7" id="new-proposalproposer-field">New <code>Proposal.Proposer</code> field<a href="#new-proposalproposer-field" class="hash-link" aria-label="Direct link to new-proposalproposer-field" title="Direct link to new-proposalproposer-field">​</a></h5><p>The <code>Proposal</code> proto has been updated with proposer field. For proposal state migraton developers can call <code>v4.AddProposerAddressToProposal</code> in their upgrade handler to update all existing proposal and make them compatible and <strong>this migration is optional</strong>.</p><div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    sdk </span><span class="token string" style="color:#e3116c">&quot;github.com/cosmos/cosmos-sdk/types&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;github.com/cosmos/cosmos-sdk/types/module&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    v4 </span><span class="token string" style="color:#e3116c">&quot;github.com/cosmos/cosmos-sdk/x/gov/migrations/v4&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    upgradetypes </span><span class="token string" style="color:#e3116c">&quot;github.com/cosmos/cosmos-sdk/x/upgrade/types&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">func</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">app SimApp</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">RegisterUpgradeHandlers</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    app</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">UpgradeKeeper</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">SetUpgradeHandler</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">UpgradeName</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">func</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ctx sdk</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Context</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> plan upgradetypes</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Plan</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> fromVM module</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">VersionMap</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">module</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">VersionMap</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token builtin">error</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token comment" style="color:#999988;font-style:italic">// this migration is optional</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token comment" style="color:#999988;font-style:italic">// add proposal ids with proposers which are active (deposit or voting period)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            proposals </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">make</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">map</span><span class="token punctuation" style="color:#393A34">[</span><span class="token builtin">uint64</span><span class="token punctuation" style="color:#393A34">]</span><span class="token builtin">string</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            proposals</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;cosmos1luyncewxk4lm24k6gqy8y5dxkj0klr4tu0lmnj&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            v4</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">AddProposerAddressToProposal</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ctx</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> sdk</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">NewKVStoreKey</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">v4</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">ModuleName</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> app</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">appCodec</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> proposals</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> app</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">ModuleManager</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">RunMigrations</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ctx</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> app</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Configurator</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> fromVM</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="xconsensus"><code>x/consensus</code><a href="#xconsensus" class="hash-link" aria-label="Direct link to xconsensus" title="Direct link to xconsensus">​</a></h4><p>Introducing a new <code>x/consensus</code> module to handle managing Tendermint consensus
parameters. For migration it is required to call a specific migration to migrate
existing parameters from the deprecated <code>x/params</code> to <code>x/consensus</code> module. App
developers should ensure to call <code>baseapp.MigrateParams</code> in their upgrade handler.</p><p>Example:</p><div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">func</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">app SimApp</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">RegisterUpgradeHandlers</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> baseAppLegacySS </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> app</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">ParamsKeeper</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Subspace</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">baseapp</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Paramspace</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">WithKeyTable</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">paramstypes</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">ConsensusParamsKeyTable</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;-</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">-</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    app</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">UpgradeKeeper</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">SetUpgradeHandler</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        UpgradeName</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">func</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ctx sdk</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Context</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">_</span><span class="token plain"> upgradetypes</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Plan</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> fromVM module</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">VersionMap</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">module</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">VersionMap</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token builtin">error</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token comment" style="color:#999988;font-style:italic">// Migrate Tendermint consensus parameters from x/params module to a</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token comment" style="color:#999988;font-style:italic">// dedicated x/consensus module.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> baseapp</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">MigrateParams</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ctx</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> baseAppLegacySS</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain">app</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">ConsensusParamsKeeper</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;-</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">-</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token comment" style="color:#999988;font-style:italic">// ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> app</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">ModuleManager</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">RunMigrations</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ctx</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> app</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Configurator</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> fromVM</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The <code>x/params</code> module should still be imported in your app.go in order to handle this migration.</p><p>Because the <code>x/consensus</code> module is a new module, its store must be added while upgrading to v0.47.x:</p><div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">storetypes</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">StoreUpgrades</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Added</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token builtin">string</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                consensustypes</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">ModuleName</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h5 class="anchor anchorWithStickyNavbar_LWe7" id="appgo-changes"><code>app.go</code> changes<a href="#appgo-changes" class="hash-link" aria-label="Direct link to appgo-changes" title="Direct link to appgo-changes">​</a></h5><p>When using an <code>app.go</code> without App Wiring, the following changes are required:</p><div class="language-diff codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-diff codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token deleted-sign deleted prefix deleted" style="color:#d73a49">-</span><span class="token deleted-sign deleted line" style="color:#d73a49"> bApp.SetParamStore(app.ParamsKeeper.Subspace(baseapp.Paramspace).WithKeyTable(paramstypes.ConsensusParamsKeyTable()))</span><br></span><span class="token-line" style="color:#393A34"><span class="token deleted-sign deleted line" style="color:#d73a49"></span><span class="token inserted-sign inserted prefix inserted" style="color:#36acaa">+</span><span class="token inserted-sign inserted line" style="color:#36acaa"> app.ConsensusParamsKeeper = consensusparamkeeper.NewKeeper(appCodec, keys[consensusparamstypes.StoreKey], authtypes.NewModuleAddress(govtypes.ModuleName).String())</span><br></span><span class="token-line" style="color:#393A34"><span class="token inserted-sign inserted line" style="color:#36acaa"></span><span class="token inserted-sign inserted prefix inserted" style="color:#36acaa">+</span><span class="token inserted-sign inserted line" style="color:#36acaa"> bApp.SetParamStore(&amp;app.ConsensusParamsKeeper)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>When using App Wiring, the parameter store is automatically set for you.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="xnft-1"><code>x/nft</code><a href="#xnft-1" class="hash-link" aria-label="Direct link to xnft-1" title="Direct link to xnft-1">​</a></h4><p>The SDK does not validate anymore the <code>classID</code> and <code>nftID</code> of an NFT, for extra flexibility in your NFT implementation.
This means chain developers need to validate the <code>classID</code> and <code>nftID</code> of an NFT.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="ledger">Ledger<a href="#ledger" class="hash-link" aria-label="Direct link to Ledger" title="Direct link to Ledger">​</a></h3><p>Ledger support has been generalized to enable use of different apps and keytypes that use <code>secp256k1</code>. The Ledger interface remains the same, but it can now be provided through the Keyring <code>Options</code>, allowing higher-level chains to connect to different Ledger apps or use custom implementations. In addition, higher-level chains can provide custom key implementations around the Ledger public key, to enable greater flexibility with address generation and signing.</p><p>This is not a breaking change, as all values will default to use the standard Cosmos app implementation unless specified otherwise.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="v046x"><a href="https://github.com/cosmos/cosmos-sdk/releases/tag/v0.46.0" target="_blank" rel="noopener noreferrer">v0.46.x</a><a href="#v046x" class="hash-link" aria-label="Direct link to v046x" title="Direct link to v046x">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="go-api-changes">Go API Changes<a href="#go-api-changes" class="hash-link" aria-label="Direct link to Go API Changes" title="Direct link to Go API Changes">​</a></h3><p>The <code>replace google.golang.org/grpc</code> directive can be removed from the <code>go.mod</code>, it is no more required to block the version.</p><p>A few packages that were deprecated in the previous version are now removed.</p><p>For instance, the REST API, deprecated in v0.45, is now removed. If you have not migrated yet, please follow the <a href="https://docs.cosmos.network/v0.45/migrations/rest.html" target="_blank" rel="noopener noreferrer">instructions</a>.</p><p>To improve clarity of the API, some renaming and improvements has been done:</p><table><thead><tr><th>Package</th><th>Previous</th><th>Current</th></tr></thead><tbody><tr><td><code>simapp</code></td><td><code>encodingConfig.Marshaler</code></td><td><code>encodingConfig.Codec</code></td></tr><tr><td><code>simapp</code></td><td><code>FundAccount</code>, <code>FundModuleAccount</code></td><td>Functions moved to <code>x/bank/testutil</code></td></tr><tr><td><code>types</code></td><td><code>AccAddressFromHex</code></td><td><code>AccAddressFromHexUnsafe</code></td></tr><tr><td><code>x/auth</code></td><td><code>MempoolFeeDecorator</code></td><td>Use <code>DeductFeeDecorator</code> instead</td></tr><tr><td><code>x/bank</code></td><td><code>AddressFromBalancesStore</code></td><td><code>AddressAndDenomFromBalancesStore</code></td></tr><tr><td><code>x/gov</code></td><td><code>keeper.DeleteDeposits</code></td><td><code>keeper.DeleteAndBurnDeposits</code></td></tr><tr><td><code>x/gov</code></td><td><code>keeper.RefundDeposits</code></td><td><code>keeper.RefundAndDeleteDeposits</code></td></tr><tr><td><code>x/{mod}</code></td><td>package <code>legacy</code></td><td>package <code>migrations</code></td></tr></tbody></table><p>For the exhaustive list of API renaming, please refer to the <a href="https://github.com/cosmos/cosmos-sdk/blob/main/CHANGELOG.md" target="_blank" rel="noopener noreferrer">CHANGELOG</a>.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="new-packages">new packages<a href="#new-packages" class="hash-link" aria-label="Direct link to new packages" title="Direct link to new packages">​</a></h4><p>Additionally, new packages have been introduced in order to further split the codebase. Aliases are available for a new API breaking migration, but it is encouraged to migrate to this new packages:</p><ul><li><code>errors</code> should replace <code>types/errors</code> when registering errors or wrapping SDK errors.</li><li><code>math</code> contains the <code>Int</code> or <code>Uint</code> types that are used in the SDK.</li><li><code>x/nft</code> an NFT base module.</li><li><code>x/group</code> a group module allowing to create DAOs, multisig and policies. Greatly composes with <code>x/authz</code>.</li></ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="xauthz"><code>x/authz</code><a href="#xauthz" class="hash-link" aria-label="Direct link to xauthz" title="Direct link to xauthz">​</a></h4><ul><li><code>authz.NewMsgGrant</code> <code>expiration</code> is now a pointer. When <code>nil</code> is used, then no expiration will be set (grant won&#x27;t expire).</li><li><code>authz.NewGrant</code> takes a new argument: block time, to correctly validate expire time.</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="keyring">Keyring<a href="#keyring" class="hash-link" aria-label="Direct link to Keyring" title="Direct link to Keyring">​</a></h3><p>The keyring has been refactored in v0.46.</p><ul><li>The <code>Unsafe*</code> interfaces have been removed from the keyring package. Please use interface casting if you wish to access those unsafe functions.</li><li>The keys&#x27; implementation has been refactored to be serialized as proto.</li><li><code>keyring.NewInMemory</code> and <code>keyring.New</code> takes now a <code>codec.Codec</code>.</li><li>Take <code>keyring.Record</code> instead of <code>Info</code> as first argument in:
<em> <code>MkConsKeyOutput</code></em> <code>MkValKeyOutput</code> <!-- -->*<!-- --> <code>MkAccKeyOutput</code></li><li>Rename:
<em> <code>SavePubKey</code> to <code>SaveOfflineKey</code> and remove the <code>algo</code> argument.
</em> <code>NewMultiInfo</code>, <code>NewLedgerInfo</code> to <code>NewLegacyMultiInfo</code>, <code>newLegacyLedgerInfo</code> respectively. <!-- -->*<!-- --> <code>NewOfflineInfo</code> to <code>newLegacyOfflineInfo</code> and move it to <code>migration_test.go</code>.</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="posthandler">PostHandler<a href="#posthandler" class="hash-link" aria-label="Direct link to PostHandler" title="Direct link to PostHandler">​</a></h3><p>A <code>postHandler</code> is like an <code>antehandler</code>, but is run <em>after</em> the <code>runMsgs</code> execution. It is in the same store branch that <code>runMsgs</code>, meaning that both <code>runMsgs</code> and <code>postHandler</code>. This allows to run a custom logic after the execution of the messages.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="iavl">IAVL<a href="#iavl" class="hash-link" aria-label="Direct link to IAVL" title="Direct link to IAVL">​</a></h3><p>v0.19.0 IAVL introduces a new &quot;fast&quot; index. This index represents the latest state of the
IAVL laid out in a format that preserves data locality by key. As a result, it allows for faster queries and iterations
since data can now be read in lexicographical order that is frequent for Cosmos-SDK chains.</p><p>The first time the chain is started after the upgrade, the aforementioned index is created. The creation process
might take time and depends on the size of the latest state of the chain. For example, Osmosis takes around 15 minutes to rebuild the index.</p><p>While the index is being created, node operators can observe the following in the logs:
&quot;Upgrading IAVL storage for faster queries + execution on the live state. This may take a while&quot;. The store
key is appended to the message. The message is printed for every module that has a non-transient store.
As a result, it gives a good indication of the progress of the upgrade.</p><p>There is also downgrade and re-upgrade protection. If a node operator chooses to downgrade to IAVL pre-fast index, and then upgrade again, the index is rebuilt from scratch. This implementation detail should not be relevant in most cases. It was added as a safeguard against operator
mistakes.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="modules-3">Modules<a href="#modules-3" class="hash-link" aria-label="Direct link to Modules" title="Direct link to Modules">​</a></h3><h4 class="anchor anchorWithStickyNavbar_LWe7" id="xparams-1"><code>x/params</code><a href="#xparams-1" class="hash-link" aria-label="Direct link to xparams-1" title="Direct link to xparams-1">​</a></h4><ul><li>The <code>x/params</code> module has been deprecated in favour of each module housing and providing way to modify their parameters. Each module that has parameters that are changeable during runtime has an authority, the authority can be a module or user account. The Cosmos SDK team recommends migrating modules away from using the param module. An example of how this could look like can be found <a href="https://github.com/cosmos/cosmos-sdk/pull/12363" target="_blank" rel="noopener noreferrer">here</a>.</li><li>The Param module will be maintained until April 18, 2023. At this point the module will reach end of life and be removed from the Cosmos SDK.</li></ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="xgov-3"><code>x/gov</code><a href="#xgov-3" class="hash-link" aria-label="Direct link to xgov-3" title="Direct link to xgov-3">​</a></h4><p>The <code>gov</code> module has been greatly improved. The previous API has been moved to <code>v1beta1</code> while the new implementation is called <code>v1</code>.</p><p>In order to submit a proposal with <code>submit-proposal</code> you now need to pass a <code>proposal.json</code> file.
You can still use the old way by using <code>submit-legacy-proposal</code>. This is not recommended.
More information can be found in the gov module <a href="https://docs.cosmos.network/v0.46/modules/gov/07_client.html" target="_blank" rel="noopener noreferrer">client documentation</a>.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="xstaking"><code>x/staking</code><a href="#xstaking" class="hash-link" aria-label="Direct link to xstaking" title="Direct link to xstaking">​</a></h4><p>The <code>staking module</code> added a new message type to cancel unbonding delegations. Users that have unbonded by accident or wish to cancel an undelegation can now specify the amount and validator they would like to cancel the unbond from</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="protobuf-3">Protobuf<a href="#protobuf-3" class="hash-link" aria-label="Direct link to Protobuf" title="Direct link to Protobuf">​</a></h3><p>The <code>third_party/proto</code> folder that existed in <a href="https://github.com/cosmos/cosmos-sdk/tree/v0.45.3/third_party/proto" target="_blank" rel="noopener noreferrer">previous version</a> now does not contain directly the <a href="https://github.com/cosmos/cosmos-sdk/tree/release/v0.46.x/third_party/proto" target="_blank" rel="noopener noreferrer">proto files</a>.</p><p>Instead, the SDK uses <a href="https://buf.build" target="_blank" rel="noopener noreferrer"><code>buf</code></a>. Clients should have their own <a href="https://docs.buf.build/configuration/v1/buf-yaml" target="_blank" rel="noopener noreferrer"><code>buf.yaml</code></a> with <code>buf.build/cosmos/cosmos-sdk</code> as dependency, in order to avoid having to copy paste these files.</p><p>The protos can as well be downloaded using <code>buf export buf.build/cosmos/cosmos-sdk:8cb30a2c4de74dc9bd8d260b1e75e176 --output &lt;some_folder&gt;</code>.</p><p>Cosmos message protobufs should be extended with <code>cosmos.msg.v1.signer</code>:</p><div class="language-protobuf codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-protobuf codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">message</span><span class="token plain"> </span><span class="token class-name">MsgSetWithdrawAddress</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">option</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">cosmos</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">msg</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">v1</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">signer</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;delegator_address&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">++</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">option</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">gogoproto</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">equal</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">           </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">false</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">option</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">gogoproto</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">goproto_getters</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">false</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token builtin">string</span><span class="token plain"> delegator_address </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">cosmos_proto</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">scalar</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;cosmos.AddressString&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token builtin">string</span><span class="token plain"> withdraw_address  </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">cosmos_proto</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">scalar</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;cosmos.AddressString&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>When clients interact with a node they are required to set a codec in the grpc.Dial. More information can be found in this <a href="https://docs.cosmos.network/v0.46/run-node/interact-node.html#programmatically-via-go" target="_blank" rel="noopener noreferrer">doc</a>.</p></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/main/build/migrations/intro"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">SDK Migrations</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/main/build/packages"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Packages</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#unreleased" class="table-of-contents__link toc-highlight">Unreleased</a><ul><li><a href="#baseapp" class="table-of-contents__link toc-highlight">BaseApp</a></li></ul></li><li><a href="#v052x" class="table-of-contents__link toc-highlight">v0.52.x</a><ul><li><a href="#simapp" class="table-of-contents__link toc-highlight">SimApp</a></li><li><a href="#depinject-app_configgo--appyml" class="table-of-contents__link toc-highlight">Depinject <code>app_config.go</code> / <code>app.yml</code></a></li><li><a href="#protobuf" class="table-of-contents__link toc-highlight">Protobuf</a></li><li><a href="#modules" class="table-of-contents__link toc-highlight">Modules</a></li></ul></li><li><a href="#v050x" class="table-of-contents__link toc-highlight">v0.50.x</a><ul><li><a href="#migration-to-cometbft-part-2" class="table-of-contents__link toc-highlight">Migration to CometBFT (Part 2)</a></li><li><a href="#baseapp-1" class="table-of-contents__link toc-highlight">BaseApp</a></li><li><a href="#config-files" class="table-of-contents__link toc-highlight">Config files</a></li><li><a href="#protobuf-1" class="table-of-contents__link toc-highlight">Protobuf</a></li><li><a href="#simapp-1" class="table-of-contents__link toc-highlight">SimApp</a></li><li><a href="#packages" class="table-of-contents__link toc-highlight">Packages</a></li><li><a href="#modules-1" class="table-of-contents__link toc-highlight">Modules</a></li><li><a href="#tooling" class="table-of-contents__link toc-highlight">Tooling</a></li></ul></li><li><a href="#v047x" class="table-of-contents__link toc-highlight">v0.47.x</a><ul><li><a href="#migration-to-cometbft-part-1" class="table-of-contents__link toc-highlight">Migration to CometBFT (Part 1)</a></li><li><a href="#simulation-1" class="table-of-contents__link toc-highlight">Simulation</a></li><li><a href="#grpc" class="table-of-contents__link toc-highlight">gRPC</a></li><li><a href="#appmodule-interface" class="table-of-contents__link toc-highlight">AppModule Interface</a></li><li><a href="#simapp-2" class="table-of-contents__link toc-highlight">SimApp</a></li><li><a href="#protobuf-2" class="table-of-contents__link toc-highlight">Protobuf</a></li><li><a href="#transactions" class="table-of-contents__link toc-highlight">Transactions</a></li><li><a href="#modules-2" class="table-of-contents__link toc-highlight">Modules</a></li><li><a href="#ledger" class="table-of-contents__link toc-highlight">Ledger</a></li></ul></li><li><a href="#v046x" class="table-of-contents__link toc-highlight">v0.46.x</a><ul><li><a href="#go-api-changes" class="table-of-contents__link toc-highlight">Go API Changes</a></li><li><a href="#keyring" class="table-of-contents__link toc-highlight">Keyring</a></li><li><a href="#posthandler" class="table-of-contents__link toc-highlight">PostHandler</a></li><li><a href="#iavl" class="table-of-contents__link toc-highlight">IAVL</a></li><li><a href="#modules-3" class="table-of-contents__link toc-highlight">Modules</a></li><li><a href="#protobuf-3" class="table-of-contents__link toc-highlight">Protobuf</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title"></div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://cosmos.network"><img src="/img/logo-bw.svg" alt="Cosmos Logo"></a></li></ul></div><div class="col footer__col"><div class="footer__title">Documentation</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://hub.cosmos.network" target="_blank" rel="noopener noreferrer" class="footer__link-item">Cosmos Hub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://docs.cometbft.com" target="_blank" rel="noopener noreferrer" class="footer__link-item">CometBFT<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://ibc.cosmos.network" target="_blank" rel="noopener noreferrer" class="footer__link-item">IBC Go<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a class="footer__link-item" href="/api">REST API</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://blog.cosmos.network" target="_blank" rel="noopener noreferrer" class="footer__link-item">Blog<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://forum.cosmos.network" target="_blank" rel="noopener noreferrer" class="footer__link-item">Forum<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://discord.gg/interchain" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://reddit.com/r/cosmosnetwork" target="_blank" rel="noopener noreferrer" class="footer__link-item">Reddit<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">Social</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://discord.gg/interchain" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/cosmos_sdk" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://www.youtube.com/c/CosmosProject" target="_blank" rel="noopener noreferrer" class="footer__link-item">Youtube<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://t.me/cosmosproject" target="_blank" rel="noopener noreferrer" class="footer__link-item">Telegram<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright"><p>The development of the Cosmos SDK is led primarily by <a href="https://interchain.io/ecosystem">Interchain Core Teams</a>. Funding for this development comes primarily from the Interchain Foundation, a Swiss non-profit.</p></div></div></div></footer></div>
<script src="/assets/js/runtime~main.ae6eca12.js"></script>
<script src="/assets/js/main.5e40e4cd.js"></script>
</body>
</html>